2025-06-10 01:51:08,078 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 01:51:08,096 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 17455 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 01:51:08,097 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 01:51:08,097 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 01:51:08,617 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 01:51:08,640 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 01:51:09,015 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 01:51:09,019 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 01:51:09,020 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 01:51:09,020 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 01:51:09,043 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 01:51:09,043 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 923 ms
2025-06-10 01:51:09,118 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 01:51:09,195 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 01:51:09,196 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 01:51:09,201 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 01:51:09,267 ERROR o.s.b.w.e.t.TomcatStarter [main] Error starting Tomcat context. Exception: org.springframework.beans.factory.UnsatisfiedDependencyException. Message: Error creating bean with name 'jwtRequestFilter': Unsatisfied dependency expressed through field 'userDetailsService': Error creating bean with name 'customUserDetailsService' defined in file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/com/example/referral/security/CustomUserDetailsService.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userRepository' defined in com.example.referral.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
2025-06-10 01:51:09,279 INFO o.a.j.l.DirectJDKLog [main] Stopping service [Tomcat]
2025-06-10 01:51:09,282 WARN o.s.c.s.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Unable to start web server
2025-06-10 01:51:09,282 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2025-06-10 01:51:09,283 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2025-06-10 01:51:09,292 INFO o.s.b.a.l.ConditionEvaluationReportLogger [main] 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-06-10 01:51:09,300 ERROR o.s.b.SpringApplication [main] Application run failed
org.springframework.context.ApplicationContextException: Unable to start web server
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:165)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:618)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:334)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.referral.UserReferralApplication.main(UserReferralApplication.java:12)
Caused by: org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:145)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.<init>(TomcatWebServer.java:105)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:499)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:218)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:188)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:162)
	... 8 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'jwtRequestFilter': Unsatisfied dependency expressed through field 'userDetailsService': Error creating bean with name 'customUserDetailsService' defined in file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/com/example/referral/security/CustomUserDetailsService.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userRepository' defined in com.example.referral.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:787)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:204)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:210)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:173)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:168)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAdaptableBeans(ServletContextInitializerBeans.java:153)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.<init>(ServletContextInitializerBeans.java:86)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:266)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:240)
	at org.springframework.boot.web.embedded.tomcat.TomcatStarter.onStartup(TomcatStarter.java:52)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4866)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1332)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1322)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:148)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:866)
	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:845)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1332)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1322)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:148)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:866)
	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:240)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:433)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:921)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.startup.Tomcat.start(Tomcat.java:437)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:126)
	... 13 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'customUserDetailsService' defined in file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/com/example/referral/security/CustomUserDetailsService.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userRepository' defined in com.example.referral.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:798)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:237)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1355)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1192)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784)
	... 55 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userRepository' defined in com.example.referral.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:377)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:135)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1685)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1434)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:907)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:785)
	... 68 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jpaSharedEM_entityManagerFactory': Cannot resolve reference to bean 'entityManagerFactory' while setting constructor argument
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:377)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:135)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveConstructorArguments(ConstructorResolver.java:685)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:509)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1335)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1165)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:365)
	... 82 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #1 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:312)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:365)
	... 94 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:282)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
	at org.springframework.boot.jdbc.init.DataSourceScriptDatabaseInitializer.runScripts(DataSourceScriptDatabaseInitializer.java:87)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.runScripts(AbstractScriptDatabaseInitializer.java:146)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyScripts(AbstractScriptDatabaseInitializer.java:108)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyDataScripts(AbstractScriptDatabaseInitializer.java:102)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.initializeDatabase(AbstractScriptDatabaseInitializer.java:77)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.afterPropertiesSet(AbstractScriptDatabaseInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782)
	... 103 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "USERS" not found (this database is empty); SQL statement:
INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) [42104-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8051)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8035)
	at org.h2.command.Parser.readTableOrView(Parser.java:8024)
	at org.h2.command.Parser.readTableOrView(Parser.java:7990)
	at org.h2.command.Parser.parseInsert(Parser.java:1540)
	at org.h2.command.Parser.parsePrepared(Parser.java:719)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
	... 113 common frames omitted
2025-06-10 01:52:48,613 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 01:52:48,626 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 17490 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 01:52:48,626 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 01:52:48,627 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 01:52:49,185 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 01:52:49,210 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 22 ms. Found 3 JPA repository interfaces.
2025-06-10 01:52:49,597 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 01:52:49,602 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 01:52:49,603 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 01:52:49,603 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 01:52:49,626 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 01:52:49,626 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 976 ms
2025-06-10 01:52:49,708 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 01:52:49,789 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 01:52:49,789 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 01:52:49,795 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 01:52:49,869 ERROR o.s.b.w.e.t.TomcatStarter [main] Error starting Tomcat context. Exception: org.springframework.beans.factory.UnsatisfiedDependencyException. Message: Error creating bean with name 'jwtRequestFilter': Unsatisfied dependency expressed through field 'userDetailsService': Error creating bean with name 'customUserDetailsService' defined in file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/com/example/referral/security/CustomUserDetailsService.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userRepository' defined in com.example.referral.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
2025-06-10 01:52:49,883 INFO o.a.j.l.DirectJDKLog [main] Stopping service [Tomcat]
2025-06-10 01:52:49,885 WARN o.s.c.s.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Unable to start web server
2025-06-10 01:52:49,886 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2025-06-10 01:52:49,887 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2025-06-10 01:52:49,897 INFO o.s.b.a.l.ConditionEvaluationReportLogger [main] 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-06-10 01:52:49,905 ERROR o.s.b.SpringApplication [main] Application run failed
org.springframework.context.ApplicationContextException: Unable to start web server
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:165)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:618)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:334)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.referral.UserReferralApplication.main(UserReferralApplication.java:12)
Caused by: org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:145)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.<init>(TomcatWebServer.java:105)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:499)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:218)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:188)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:162)
	... 8 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'jwtRequestFilter': Unsatisfied dependency expressed through field 'userDetailsService': Error creating bean with name 'customUserDetailsService' defined in file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/com/example/referral/security/CustomUserDetailsService.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userRepository' defined in com.example.referral.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:787)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:204)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:210)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:173)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:168)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAdaptableBeans(ServletContextInitializerBeans.java:153)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.<init>(ServletContextInitializerBeans.java:86)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:266)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:240)
	at org.springframework.boot.web.embedded.tomcat.TomcatStarter.onStartup(TomcatStarter.java:52)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4866)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1332)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1322)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:317)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:148)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:866)
	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:845)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1332)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1322)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:317)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:148)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:866)
	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:240)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:433)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:921)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.startup.Tomcat.start(Tomcat.java:437)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:126)
	... 13 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'customUserDetailsService' defined in file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/com/example/referral/security/CustomUserDetailsService.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userRepository' defined in com.example.referral.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:798)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:237)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1355)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1192)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784)
	... 57 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userRepository' defined in com.example.referral.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:377)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:135)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1685)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1434)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:907)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:785)
	... 70 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jpaSharedEM_entityManagerFactory': Cannot resolve reference to bean 'entityManagerFactory' while setting constructor argument
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:377)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:135)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveConstructorArguments(ConstructorResolver.java:685)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:509)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1335)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1165)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:365)
	... 84 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #1 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:312)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:365)
	... 96 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:282)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
	at org.springframework.boot.jdbc.init.DataSourceScriptDatabaseInitializer.runScripts(DataSourceScriptDatabaseInitializer.java:87)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.runScripts(AbstractScriptDatabaseInitializer.java:146)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyScripts(AbstractScriptDatabaseInitializer.java:108)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyDataScripts(AbstractScriptDatabaseInitializer.java:102)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.initializeDatabase(AbstractScriptDatabaseInitializer.java:77)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.afterPropertiesSet(AbstractScriptDatabaseInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782)
	... 105 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "USERS" not found (this database is empty); SQL statement:
INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) [42104-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8051)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8035)
	at org.h2.command.Parser.readTableOrView(Parser.java:8024)
	at org.h2.command.Parser.readTableOrView(Parser.java:7990)
	at org.h2.command.Parser.parseInsert(Parser.java:1540)
	at org.h2.command.Parser.parsePrepared(Parser.java:719)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
	... 115 common frames omitted
2025-06-10 01:56:39,980 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 01:56:39,996 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 17797 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 01:56:39,996 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 01:56:39,996 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 01:56:40,539 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 01:56:40,562 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 01:56:40,935 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 01:56:40,940 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 01:56:40,941 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 01:56:40,941 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 01:56:40,962 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 01:56:40,962 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 944 ms
2025-06-10 01:56:41,037 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 01:56:41,116 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 01:56:41,117 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 01:56:41,122 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 01:56:41,219 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 01:56:41,248 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 01:56:41,262 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 01:56:41,356 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 01:56:41,381 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 01:56:41,800 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 01:56:41,806 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profile cascade 
2025-06-10 01:56:41,808 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 01:56:41,808 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 01:56:41,810 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profile (
        dob date not null,
        id bigint generated by default as identity,
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 01:56:41,814 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        completed_at timestamp(6),
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint,
        status varchar(255) check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 01:56:41,817 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer not null,
        id bigint generated by default as identity,
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 01:56:41,818 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profile 
       add constraint FKs14jvsf9tqrcnly0afsv0ngwv 
       foreign key (user_id) 
       references users
2025-06-10 01:56:41,822 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 01:56:41,822 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 01:56:41,824 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 01:56:42,019 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 01:56:42,203 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 01:56:42,469 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 01:56:42,507 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@2b991034, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@666033b1, org.springframework.security.web.context.SecurityContextHolderFilter@63714a1, org.springframework.security.web.header.HeaderWriterFilter@2227c82d, org.springframework.web.filter.CorsFilter@db9ecd, org.springframework.security.web.authentication.logout.LogoutFilter@2f4a89fa, com.example.referral.security.JwtRequestFilter@64ee9290, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@158774d3, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@196519dd, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@23ac164d, org.springframework.security.web.session.SessionManagementFilter@7900d917, org.springframework.security.web.access.ExceptionTranslationFilter@1e9d5d79, org.springframework.security.web.access.intercept.AuthorizationFilter@6e44825e]
2025-06-10 01:56:42,779 WARN o.s.c.s.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #1 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
2025-06-10 01:56:42,782 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 01:56:42,782 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profile cascade 
2025-06-10 01:56:42,783 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 01:56:42,784 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 01:56:42,785 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2025-06-10 01:56:42,786 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2025-06-10 01:56:42,787 INFO o.a.j.l.DirectJDKLog [main] Stopping service [Tomcat]
2025-06-10 01:56:42,797 INFO o.s.b.a.l.ConditionEvaluationReportLogger [main] 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-06-10 01:56:42,804 ERROR o.s.b.SpringApplication [main] Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #1 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:312)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:959)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:334)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.referral.UserReferralApplication.main(UserReferralApplication.java:12)
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:282)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
	at org.springframework.boot.jdbc.init.DataSourceScriptDatabaseInitializer.runScripts(DataSourceScriptDatabaseInitializer.java:87)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.runScripts(AbstractScriptDatabaseInitializer.java:146)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyScripts(AbstractScriptDatabaseInitializer.java:108)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyDataScripts(AbstractScriptDatabaseInitializer.java:102)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.initializeDatabase(AbstractScriptDatabaseInitializer.java:77)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.afterPropertiesSet(AbstractScriptDatabaseInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782)
	... 18 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "CREATED_AT" not found; SQL statement:
INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345', 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.table.Table.getColumn(Table.java:759)
	at org.h2.command.Parser.parseColumn(Parser.java:1190)
	at org.h2.command.Parser.parseColumnList(Parser.java:1175)
	at org.h2.command.Parser.parseInsert(Parser.java:1549)
	at org.h2.command.Parser.parsePrepared(Parser.java:719)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
	... 28 common frames omitted
2025-06-10 01:59:53,901 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 01:59:53,916 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 17871 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 01:59:53,916 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 01:59:53,917 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 01:59:54,409 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 01:59:54,432 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 01:59:54,804 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 01:59:54,809 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 01:59:54,810 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 01:59:54,810 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 01:59:54,832 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 01:59:54,832 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 890 ms
2025-06-10 01:59:54,908 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 01:59:54,990 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 01:59:54,991 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 01:59:54,996 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 01:59:55,088 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 01:59:55,118 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 01:59:55,133 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 01:59:55,233 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 01:59:55,253 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 01:59:55,667 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 01:59:55,673 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profile cascade 
2025-06-10 01:59:55,675 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 01:59:55,675 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 01:59:55,677 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profile (
        dob date not null,
        id bigint generated by default as identity,
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 01:59:55,681 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        completed_at timestamp(6),
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint,
        status varchar(255) check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 01:59:55,683 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer not null,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 01:59:55,684 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profile 
       add constraint FKs14jvsf9tqrcnly0afsv0ngwv 
       foreign key (user_id) 
       references users
2025-06-10 01:59:55,688 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 01:59:55,689 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 01:59:55,691 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 01:59:55,877 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 01:59:56,066 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 01:59:56,315 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 01:59:56,351 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@11e323a6, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@704205ef, org.springframework.security.web.context.SecurityContextHolderFilter@12639753, org.springframework.security.web.header.HeaderWriterFilter@39aa595, org.springframework.web.filter.CorsFilter@18ee9a8f, org.springframework.security.web.authentication.logout.LogoutFilter@71702d3f, com.example.referral.security.JwtRequestFilter@238cac6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3253d771, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@453c10c2, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@61aaec51, org.springframework.security.web.session.SessionManagementFilter@466fb9be, org.springframework.security.web.access.ExceptionTranslationFilter@3ed79f41, org.springframework.security.web.access.intercept.AuthorizationFilter@45144fdf]
2025-06-10 01:59:56,633 WARN o.s.c.s.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #2 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status, created_at, updated_at) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
2025-06-10 01:59:56,636 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 01:59:56,636 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profile cascade 
2025-06-10 01:59:56,637 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 01:59:56,637 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 01:59:56,639 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2025-06-10 01:59:56,639 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2025-06-10 01:59:56,640 INFO o.a.j.l.DirectJDKLog [main] Stopping service [Tomcat]
2025-06-10 01:59:56,650 INFO o.s.b.a.l.ConditionEvaluationReportLogger [main] 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-06-10 01:59:56,656 ERROR o.s.b.SpringApplication [main] Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #2 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status, created_at, updated_at) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:312)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:959)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:334)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.referral.UserReferralApplication.main(UserReferralApplication.java:12)
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #2 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status, created_at, updated_at) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:282)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
	at org.springframework.boot.jdbc.init.DataSourceScriptDatabaseInitializer.runScripts(DataSourceScriptDatabaseInitializer.java:87)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.runScripts(AbstractScriptDatabaseInitializer.java:146)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyScripts(AbstractScriptDatabaseInitializer.java:108)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyDataScripts(AbstractScriptDatabaseInitializer.java:102)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.initializeDatabase(AbstractScriptDatabaseInitializer.java:77)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.afterPropertiesSet(AbstractScriptDatabaseInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782)
	... 18 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "REFERRALS" not found; SQL statement:
INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status, created_at, updated_at) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) [42102-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8064)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8035)
	at org.h2.command.Parser.readTableOrView(Parser.java:8024)
	at org.h2.command.Parser.readTableOrView(Parser.java:7990)
	at org.h2.command.Parser.parseInsert(Parser.java:1540)
	at org.h2.command.Parser.parsePrepared(Parser.java:719)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
	... 28 common frames omitted
2025-06-10 02:01:36,792 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 02:01:36,806 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 17913 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 02:01:36,806 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 02:01:36,806 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 02:01:37,321 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 02:01:37,345 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 21 ms. Found 3 JPA repository interfaces.
2025-06-10 02:01:37,716 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 02:01:37,720 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 02:01:37,721 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 02:01:37,721 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 02:01:37,742 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 02:01:37,742 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 910 ms
2025-06-10 02:01:37,815 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 02:01:37,894 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 02:01:37,895 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 02:01:37,905 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 02:01:38,000 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 02:01:38,028 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 02:01:38,042 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 02:01:38,143 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 02:01:38,162 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 02:01:38,598 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 02:01:38,604 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profile cascade 
2025-06-10 02:01:38,605 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:01:38,606 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:01:38,608 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profile (
        dob date not null,
        id bigint generated by default as identity,
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 02:01:38,612 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        completed_at timestamp(6),
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint,
        status varchar(255) check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 02:01:38,614 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 02:01:38,615 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profile 
       add constraint FKs14jvsf9tqrcnly0afsv0ngwv 
       foreign key (user_id) 
       references users
2025-06-10 02:01:38,620 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 02:01:38,620 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 02:01:38,622 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:01:38,830 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 02:01:39,011 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 02:01:39,295 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 02:01:39,338 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@1d9db780, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@759fe679, org.springframework.security.web.context.SecurityContextHolderFilter@11f8d64, org.springframework.security.web.header.HeaderWriterFilter@6987a0f3, org.springframework.web.filter.CorsFilter@7056cda8, org.springframework.security.web.authentication.logout.LogoutFilter@2d17b6ad, com.example.referral.security.JwtRequestFilter@57e9cd2, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4af32714, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@18c2b4c6, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2fbbdca, org.springframework.security.web.session.SessionManagementFilter@208bde64, org.springframework.security.web.access.ExceptionTranslationFilter@5066a895, org.springframework.security.web.access.intercept.AuthorizationFilter@4398d]
2025-06-10 02:01:39,633 WARN o.s.c.s.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #1 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123'), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456'), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789'), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012'), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345')
2025-06-10 02:01:39,636 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:01:39,637 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profile cascade 
2025-06-10 02:01:39,637 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:01:39,638 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:01:39,639 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2025-06-10 02:01:39,640 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2025-06-10 02:01:39,641 INFO o.a.j.l.DirectJDKLog [main] Stopping service [Tomcat]
2025-06-10 02:01:39,652 INFO o.s.b.a.l.ConditionEvaluationReportLogger [main] 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-06-10 02:01:39,659 ERROR o.s.b.SpringApplication [main] Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #1 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123'), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456'), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789'), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012'), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345')
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:312)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:959)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:334)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.referral.UserReferralApplication.main(UserReferralApplication.java:12)
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123'), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456'), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789'), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012'), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345')
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:282)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
	at org.springframework.boot.jdbc.init.DataSourceScriptDatabaseInitializer.runScripts(DataSourceScriptDatabaseInitializer.java:87)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.runScripts(AbstractScriptDatabaseInitializer.java:146)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyScripts(AbstractScriptDatabaseInitializer.java:108)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyDataScripts(AbstractScriptDatabaseInitializer.java:102)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.initializeDatabase(AbstractScriptDatabaseInitializer.java:77)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.afterPropertiesSet(AbstractScriptDatabaseInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782)
	... 18 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException: Column count does not match; SQL statement:
INSERT INTO users (email, password, name, referral_code, referral_points, created_at, updated_at) VALUES ('john.doe@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'John Doe', 'ABC123'), ('jane.smith@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Jane Smith', 'DEF456'), ('bob.wilson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Bob Wilson', 'GHI789'), ('alice.johnson@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Alice Johnson', 'JKL012'), ('charlie.brown@example.com', '$2a$10$xn3LI/AjqicFYZFruSwve.681477XaVNaUQbr1gioaWPn4t1KsnmG', 'Charlie Brown', 'MNO345') [21002-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.command.dml.Insert.doPrepare(Insert.java:295)
	at org.h2.command.dml.DataChangeStatement.prepare(DataChangeStatement.java:37)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
	... 28 common frames omitted
2025-06-10 02:04:34,842 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 02:04:34,859 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 17984 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 02:04:34,859 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 02:04:34,860 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 02:04:35,373 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 02:04:35,396 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 02:04:35,778 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 02:04:35,783 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 02:04:35,784 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 02:04:35,784 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 02:04:35,806 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 02:04:35,806 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 923 ms
2025-06-10 02:04:35,882 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 02:04:35,971 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 02:04:35,972 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 02:04:35,978 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 02:04:36,077 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 02:04:36,106 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 02:04:36,121 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 02:04:36,225 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 02:04:36,247 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 02:04:36,675 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 02:04:36,681 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profile cascade 
2025-06-10 02:04:36,683 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:04:36,683 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:04:36,685 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profile (
        dob date not null,
        id bigint generated by default as identity,
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 02:04:36,689 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        completed_at timestamp(6),
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint,
        status varchar(255) check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 02:04:36,691 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 02:04:36,692 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profile 
       add constraint FKs14jvsf9tqrcnly0afsv0ngwv 
       foreign key (user_id) 
       references users
2025-06-10 02:04:36,696 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 02:04:36,697 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 02:04:36,699 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:04:36,892 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 02:04:37,090 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 02:04:37,345 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 02:04:37,392 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@43baf0b9, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@653e79fc, org.springframework.security.web.context.SecurityContextHolderFilter@d5d9d92, org.springframework.security.web.header.HeaderWriterFilter@2087181d, org.springframework.web.filter.CorsFilter@ebd4486, org.springframework.security.web.authentication.logout.LogoutFilter@13eb8ca, com.example.referral.security.JwtRequestFilter@57e9cd2, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@aad1270, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@473ee461, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@69c413f7, org.springframework.security.web.session.SessionManagementFilter@74efc394, org.springframework.security.web.access.ExceptionTranslationFilter@12bb0322, org.springframework.security.web.access.intercept.AuthorizationFilter@426fb1c3]
2025-06-10 02:04:37,666 WARN o.s.c.s.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #2 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status, created_at, updated_at) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
2025-06-10 02:04:37,669 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:04:37,669 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profile cascade 
2025-06-10 02:04:37,670 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:04:37,671 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:04:37,672 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2025-06-10 02:04:37,673 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2025-06-10 02:04:37,674 INFO o.a.j.l.DirectJDKLog [main] Stopping service [Tomcat]
2025-06-10 02:04:37,684 INFO o.s.b.a.l.ConditionEvaluationReportLogger [main] 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-06-10 02:04:37,690 ERROR o.s.b.SpringApplication [main] Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #2 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status, created_at, updated_at) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:312)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:959)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:334)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.referral.UserReferralApplication.main(UserReferralApplication.java:12)
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #2 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status, created_at, updated_at) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:282)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
	at org.springframework.boot.jdbc.init.DataSourceScriptDatabaseInitializer.runScripts(DataSourceScriptDatabaseInitializer.java:87)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.runScripts(AbstractScriptDatabaseInitializer.java:146)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyScripts(AbstractScriptDatabaseInitializer.java:108)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyDataScripts(AbstractScriptDatabaseInitializer.java:102)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.initializeDatabase(AbstractScriptDatabaseInitializer.java:77)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.afterPropertiesSet(AbstractScriptDatabaseInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782)
	... 18 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "REFERRALS" not found; SQL statement:
INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status, created_at, updated_at) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) [42102-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8064)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8035)
	at org.h2.command.Parser.readTableOrView(Parser.java:8024)
	at org.h2.command.Parser.readTableOrView(Parser.java:7990)
	at org.h2.command.Parser.parseInsert(Parser.java:1540)
	at org.h2.command.Parser.parsePrepared(Parser.java:719)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
	... 28 common frames omitted
2025-06-10 02:08:11,246 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 02:08:11,261 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 18067 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 02:08:11,261 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 02:08:11,261 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 02:08:11,755 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 02:08:11,777 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 02:08:12,146 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 02:08:12,150 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 02:08:12,151 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 02:08:12,151 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 02:08:12,171 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 02:08:12,171 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 889 ms
2025-06-10 02:08:12,245 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 02:08:12,322 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 02:08:12,323 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 02:08:12,328 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 02:08:12,423 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 02:08:12,453 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 02:08:12,466 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 02:08:12,564 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 02:08:12,583 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 02:08:13,004 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 02:08:13,010 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profile cascade 
2025-06-10 02:08:13,012 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:08:13,012 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:08:13,015 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profile (
        dob date not null,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 02:08:13,019 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint,
        updated_at timestamp(6),
        status varchar(255) check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 02:08:13,021 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 02:08:13,022 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profile 
       add constraint FKs14jvsf9tqrcnly0afsv0ngwv 
       foreign key (user_id) 
       references users
2025-06-10 02:08:13,026 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 02:08:13,027 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 02:08:13,029 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:08:13,216 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 02:08:13,409 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 02:08:13,657 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 02:08:13,694 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5ac25491, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5b115d71, org.springframework.security.web.context.SecurityContextHolderFilter@2a62384, org.springframework.security.web.header.HeaderWriterFilter@3d805670, org.springframework.web.filter.CorsFilter@4398d, org.springframework.security.web.authentication.logout.LogoutFilter@3f46fb53, com.example.referral.security.JwtRequestFilter@2298d741, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7fe1a856, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@489ec791, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@18a8a40e, org.springframework.security.web.session.SessionManagementFilter@7c5a7f, org.springframework.security.web.access.ExceptionTranslationFilter@339b9869, org.springframework.security.web.access.intercept.AuthorizationFilter@18ee9a8f]
2025-06-10 02:08:13,982 WARN o.s.c.s.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #2 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO profiles (user_id, street, city, state, zip_code, phone_number, dob) VALUES (1, '123 Main St', 'Springfield', 'IL', '62701', '555-123-4567', '1990-01-01'), (2, '456 Oak Ave', 'Chicago', 'IL', '60601', '555-234-5678', '1992-05-15'), (3, '789 Pine Rd', 'Peoria', 'IL', '61601', '555-345-6789', '1988-12-31')
2025-06-10 02:08:13,985 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:08:13,985 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profile cascade 
2025-06-10 02:08:13,986 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:08:13,987 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:08:13,988 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2025-06-10 02:08:13,989 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2025-06-10 02:08:13,990 INFO o.a.j.l.DirectJDKLog [main] Stopping service [Tomcat]
2025-06-10 02:08:14,000 INFO o.s.b.a.l.ConditionEvaluationReportLogger [main] 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-06-10 02:08:14,006 ERROR o.s.b.SpringApplication [main] Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #2 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO profiles (user_id, street, city, state, zip_code, phone_number, dob) VALUES (1, '123 Main St', 'Springfield', 'IL', '62701', '555-123-4567', '1990-01-01'), (2, '456 Oak Ave', 'Chicago', 'IL', '60601', '555-234-5678', '1992-05-15'), (3, '789 Pine Rd', 'Peoria', 'IL', '61601', '555-345-6789', '1988-12-31')
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:312)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:959)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:334)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.referral.UserReferralApplication.main(UserReferralApplication.java:12)
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #2 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO profiles (user_id, street, city, state, zip_code, phone_number, dob) VALUES (1, '123 Main St', 'Springfield', 'IL', '62701', '555-123-4567', '1990-01-01'), (2, '456 Oak Ave', 'Chicago', 'IL', '60601', '555-234-5678', '1992-05-15'), (3, '789 Pine Rd', 'Peoria', 'IL', '61601', '555-345-6789', '1988-12-31')
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:282)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
	at org.springframework.boot.jdbc.init.DataSourceScriptDatabaseInitializer.runScripts(DataSourceScriptDatabaseInitializer.java:87)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.runScripts(AbstractScriptDatabaseInitializer.java:146)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyScripts(AbstractScriptDatabaseInitializer.java:108)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyDataScripts(AbstractScriptDatabaseInitializer.java:102)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.initializeDatabase(AbstractScriptDatabaseInitializer.java:77)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.afterPropertiesSet(AbstractScriptDatabaseInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782)
	... 18 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "PROFILES" not found; SQL statement:
INSERT INTO profiles (user_id, street, city, state, zip_code, phone_number, dob) VALUES (1, '123 Main St', 'Springfield', 'IL', '62701', '555-123-4567', '1990-01-01'), (2, '456 Oak Ave', 'Chicago', 'IL', '60601', '555-234-5678', '1992-05-15'), (3, '789 Pine Rd', 'Peoria', 'IL', '61601', '555-345-6789', '1988-12-31') [42102-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8064)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8035)
	at org.h2.command.Parser.readTableOrView(Parser.java:8024)
	at org.h2.command.Parser.readTableOrView(Parser.java:7990)
	at org.h2.command.Parser.parseInsert(Parser.java:1540)
	at org.h2.command.Parser.parsePrepared(Parser.java:719)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
	... 28 common frames omitted
2025-06-10 02:12:57,299 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 18177 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 02:12:57,300 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 02:12:57,300 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 02:12:57,799 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 02:12:57,821 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 02:12:58,182 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 02:12:58,187 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 02:12:58,187 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 02:12:58,187 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 02:12:58,207 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 02:12:58,208 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 886 ms
2025-06-10 02:12:58,280 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 02:12:58,359 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 02:12:58,360 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 02:12:58,365 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 02:12:58,440 ERROR o.s.b.w.e.t.TomcatStarter [main] Error starting Tomcat context. Exception: org.springframework.beans.factory.UnsatisfiedDependencyException. Message: Error creating bean with name 'jwtRequestFilter': Unsatisfied dependency expressed through field 'userDetailsService': Error creating bean with name 'customUserDetailsService' defined in file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/com/example/referral/security/CustomUserDetailsService.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userRepository' defined in com.example.referral.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
2025-06-10 02:12:58,453 INFO o.a.j.l.DirectJDKLog [main] Stopping service [Tomcat]
2025-06-10 02:12:58,456 WARN o.s.c.s.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Unable to start web server
2025-06-10 02:12:58,456 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2025-06-10 02:12:58,457 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2025-06-10 02:12:58,466 INFO o.s.b.a.l.ConditionEvaluationReportLogger [main] 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-06-10 02:12:58,474 ERROR o.s.b.SpringApplication [main] Application run failed
org.springframework.context.ApplicationContextException: Unable to start web server
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:165)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:618)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:334)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.referral.UserReferralApplication.main(UserReferralApplication.java:12)
Caused by: org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:145)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.<init>(TomcatWebServer.java:105)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:499)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:218)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:188)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:162)
	... 8 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'jwtRequestFilter': Unsatisfied dependency expressed through field 'userDetailsService': Error creating bean with name 'customUserDetailsService' defined in file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/com/example/referral/security/CustomUserDetailsService.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userRepository' defined in com.example.referral.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:787)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:204)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:210)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:173)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:168)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAdaptableBeans(ServletContextInitializerBeans.java:153)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.<init>(ServletContextInitializerBeans.java:86)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:266)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:240)
	at org.springframework.boot.web.embedded.tomcat.TomcatStarter.onStartup(TomcatStarter.java:52)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4866)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1332)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1322)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:148)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:866)
	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:845)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1332)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1322)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:148)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:866)
	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:240)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:433)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:921)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:171)
	at org.apache.catalina.startup.Tomcat.start(Tomcat.java:437)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:126)
	... 13 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'customUserDetailsService' defined in file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/com/example/referral/security/CustomUserDetailsService.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userRepository' defined in com.example.referral.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:798)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:237)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1355)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1192)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784)
	... 55 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userRepository' defined in com.example.referral.repository.UserRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:377)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:135)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1685)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1434)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:907)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:785)
	... 68 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jpaSharedEM_entityManagerFactory': Cannot resolve reference to bean 'entityManagerFactory' while setting constructor argument
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:377)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:135)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveConstructorArguments(ConstructorResolver.java:685)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:509)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1335)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1165)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:365)
	... 82 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #3 of class path resource [data.sql]: INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED'), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING'), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING')
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:312)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:365)
	... 94 common frames omitted
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of class path resource [data.sql]: INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED'), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING'), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING')
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:282)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
	at org.springframework.boot.jdbc.init.DataSourceScriptDatabaseInitializer.runScripts(DataSourceScriptDatabaseInitializer.java:87)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.runScripts(AbstractScriptDatabaseInitializer.java:146)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyScripts(AbstractScriptDatabaseInitializer.java:108)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyDataScripts(AbstractScriptDatabaseInitializer.java:102)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.initializeDatabase(AbstractScriptDatabaseInitializer.java:77)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.afterPropertiesSet(AbstractScriptDatabaseInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782)
	... 103 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "REFERRER_EMAIL" not found; SQL statement:
INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED'), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING'), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING') [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.table.Table.getColumn(Table.java:759)
	at org.h2.command.Parser.parseColumn(Parser.java:1190)
	at org.h2.command.Parser.parseColumnList(Parser.java:1175)
	at org.h2.command.Parser.parseInsert(Parser.java:1549)
	at org.h2.command.Parser.parsePrepared(Parser.java:719)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
	... 113 common frames omitted
2025-06-10 02:14:31,480 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 02:14:31,493 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 18216 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 02:14:31,493 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 02:14:31,494 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 02:14:31,993 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 02:14:32,016 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 02:14:32,375 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 02:14:32,380 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 02:14:32,381 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 02:14:32,381 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 02:14:32,400 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 02:14:32,401 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 883 ms
2025-06-10 02:14:32,471 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 02:14:32,554 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 02:14:32,555 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 02:14:32,560 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 02:14:32,651 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 02:14:32,681 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 02:14:32,695 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 02:14:32,797 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 02:14:32,818 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 02:14:33,248 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 02:14:33,254 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profiles cascade 
2025-06-10 02:14:33,256 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:14:33,256 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:14:33,258 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profiles (
        dob date not null,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 02:14:33,262 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint not null,
        updated_at timestamp(6),
        status varchar(255) not null check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 02:14:33,264 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 02:14:33,265 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profiles 
       add constraint FK410q61iev7klncmpqfuo85ivh 
       foreign key (user_id) 
       references users
2025-06-10 02:14:33,269 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 02:14:33,270 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 02:14:33,272 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:14:33,461 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 02:14:33,662 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 02:14:33,909 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 02:14:33,951 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@722a2ba2, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@788cb7b0, org.springframework.security.web.context.SecurityContextHolderFilter@11f8d64, org.springframework.security.web.header.HeaderWriterFilter@6987a0f3, org.springframework.web.filter.CorsFilter@3e711e84, org.springframework.security.web.authentication.logout.LogoutFilter@40830e1e, com.example.referral.security.JwtRequestFilter@3b303b78, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4af32714, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@347c7b, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@61bbe16d, org.springframework.security.web.session.SessionManagementFilter@208bde64, org.springframework.security.web.access.ExceptionTranslationFilter@5066a895, org.springframework.security.web.access.intercept.AuthorizationFilter@2044a11b]
2025-06-10 02:14:34,233 WARN o.s.c.s.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #3 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED'), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING'), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING')
2025-06-10 02:14:34,236 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:14:34,237 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profiles cascade 
2025-06-10 02:14:34,237 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:14:34,238 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:14:34,239 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2025-06-10 02:14:34,240 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2025-06-10 02:14:34,241 INFO o.a.j.l.DirectJDKLog [main] Stopping service [Tomcat]
2025-06-10 02:14:34,254 INFO o.s.b.a.l.ConditionEvaluationReportLogger [main] 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-06-10 02:14:34,262 ERROR o.s.b.SpringApplication [main] Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #3 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED'), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING'), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING')
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:312)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:959)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:334)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.referral.UserReferralApplication.main(UserReferralApplication.java:12)
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED'), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING'), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING')
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:282)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
	at org.springframework.boot.jdbc.init.DataSourceScriptDatabaseInitializer.runScripts(DataSourceScriptDatabaseInitializer.java:87)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.runScripts(AbstractScriptDatabaseInitializer.java:146)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyScripts(AbstractScriptDatabaseInitializer.java:108)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyDataScripts(AbstractScriptDatabaseInitializer.java:102)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.initializeDatabase(AbstractScriptDatabaseInitializer.java:77)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.afterPropertiesSet(AbstractScriptDatabaseInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782)
	... 18 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "REFERRALS" not found; SQL statement:
INSERT INTO referrals (referrer_id, referee_id, referrer_email, referee_email, status) VALUES (1, 2, 'john.doe@example.com', 'jane.smith@example.com', 'COMPLETED'), (1, 3, 'john.doe@example.com', 'bob.wilson@example.com', 'PENDING'), (2, 4, 'jane.smith@example.com', 'alice.johnson@example.com', 'PENDING') [42102-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8064)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8035)
	at org.h2.command.Parser.readTableOrView(Parser.java:8024)
	at org.h2.command.Parser.readTableOrView(Parser.java:7990)
	at org.h2.command.Parser.parseInsert(Parser.java:1540)
	at org.h2.command.Parser.parsePrepared(Parser.java:719)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
	... 28 common frames omitted
2025-06-10 02:15:20,550 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 02:15:20,564 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 18233 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 02:15:20,564 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 02:15:20,565 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 02:15:21,082 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 02:15:21,105 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 02:15:21,472 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 02:15:21,477 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 02:15:21,477 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 02:15:21,477 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 02:15:21,498 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 02:15:21,498 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 911 ms
2025-06-10 02:15:21,573 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 02:15:21,658 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 02:15:21,659 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 02:15:21,665 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 02:15:21,759 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 02:15:21,788 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 02:15:21,802 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 02:15:21,903 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 02:15:21,923 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 02:15:22,349 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 02:15:22,354 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profiles cascade 
2025-06-10 02:15:22,356 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:15:22,356 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:15:22,358 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profiles (
        dob date not null,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 02:15:22,363 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint not null,
        updated_at timestamp(6),
        status varchar(255) not null check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 02:15:22,365 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 02:15:22,366 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profiles 
       add constraint FK410q61iev7klncmpqfuo85ivh 
       foreign key (user_id) 
       references users
2025-06-10 02:15:22,371 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 02:15:22,372 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 02:15:22,374 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:15:22,561 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 02:15:22,751 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 02:15:22,997 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 02:15:23,043 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6587c92f, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@537979aa, org.springframework.security.web.context.SecurityContextHolderFilter@3253d771, org.springframework.security.web.header.HeaderWriterFilter@6eec564c, org.springframework.web.filter.CorsFilter@5ac25491, org.springframework.security.web.authentication.logout.LogoutFilter@1d3aefd, com.example.referral.security.JwtRequestFilter@79690a0a, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@76b5b1e2, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@10f03ab0, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5b115d71, org.springframework.security.web.session.SessionManagementFilter@74a121fe, org.springframework.security.web.access.ExceptionTranslationFilter@4c627575, org.springframework.security.web.access.intercept.AuthorizationFilter@11e323a6]
2025-06-10 02:15:23,313 WARN o.s.c.s.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #3 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO referrals (referrer_id, referee_id, status) VALUES (1, 2, 'COMPLETED'), (1, 3, 'PENDING'), (2, 4, 'PENDING')
2025-06-10 02:15:23,316 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:15:23,316 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profiles cascade 
2025-06-10 02:15:23,318 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:15:23,318 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:15:23,320 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2025-06-10 02:15:23,320 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2025-06-10 02:15:23,321 INFO o.a.j.l.DirectJDKLog [main] Stopping service [Tomcat]
2025-06-10 02:15:23,331 INFO o.s.b.a.l.ConditionEvaluationReportLogger [main] 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-06-10 02:15:23,344 ERROR o.s.b.SpringApplication [main] Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #3 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO referrals (referrer_id, referee_id, status) VALUES (1, 2, 'COMPLETED'), (1, 3, 'PENDING'), (2, 4, 'PENDING')
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:312)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:959)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:334)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.referral.UserReferralApplication.main(UserReferralApplication.java:12)
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #3 of file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/data.sql]: INSERT INTO referrals (referrer_id, referee_id, status) VALUES (1, 2, 'COMPLETED'), (1, 3, 'PENDING'), (2, 4, 'PENDING')
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:282)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
	at org.springframework.boot.jdbc.init.DataSourceScriptDatabaseInitializer.runScripts(DataSourceScriptDatabaseInitializer.java:87)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.runScripts(AbstractScriptDatabaseInitializer.java:146)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyScripts(AbstractScriptDatabaseInitializer.java:108)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyDataScripts(AbstractScriptDatabaseInitializer.java:102)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.initializeDatabase(AbstractScriptDatabaseInitializer.java:77)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.afterPropertiesSet(AbstractScriptDatabaseInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782)
	... 18 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "REFERRALS" not found; SQL statement:
INSERT INTO referrals (referrer_id, referee_id, status) VALUES (1, 2, 'COMPLETED'), (1, 3, 'PENDING'), (2, 4, 'PENDING') [42102-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8064)
	at org.h2.command.Parser.getTableOrViewNotFoundDbException(Parser.java:8035)
	at org.h2.command.Parser.readTableOrView(Parser.java:8024)
	at org.h2.command.Parser.readTableOrView(Parser.java:7990)
	at org.h2.command.Parser.parseInsert(Parser.java:1540)
	at org.h2.command.Parser.parsePrepared(Parser.java:719)
	at org.h2.command.Parser.parse(Parser.java:592)
	at org.h2.command.Parser.parse(Parser.java:564)
	at org.h2.command.Parser.prepareCommand(Parser.java:483)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
	... 28 common frames omitted
2025-06-10 02:17:05,362 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 02:17:05,375 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 18264 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 02:17:05,375 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 02:17:05,375 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 02:17:05,871 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 02:17:05,895 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 02:17:06,248 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 02:17:06,253 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 02:17:06,253 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 02:17:06,253 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 02:17:06,274 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 02:17:06,274 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 876 ms
2025-06-10 02:17:06,348 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 02:17:06,427 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 02:17:06,433 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 02:17:06,438 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 02:17:06,528 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 02:17:06,558 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 02:17:06,572 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 02:17:06,671 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 02:17:06,691 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 02:17:07,113 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 02:17:07,119 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profiles cascade 
2025-06-10 02:17:07,121 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:17:07,121 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:17:07,123 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profiles (
        dob date not null,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 02:17:07,127 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint not null,
        updated_at timestamp(6),
        status varchar(255) not null check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 02:17:07,130 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 02:17:07,131 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profiles 
       add constraint FK410q61iev7klncmpqfuo85ivh 
       foreign key (user_id) 
       references users
2025-06-10 02:17:07,135 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 02:17:07,136 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 02:17:07,138 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:17:07,323 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 02:17:07,510 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 02:17:07,756 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 02:17:07,791 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@489ec791, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3597174b, org.springframework.security.web.context.SecurityContextHolderFilter@54a332e4, org.springframework.security.web.header.HeaderWriterFilter@10db002c, org.springframework.web.filter.CorsFilter@24a38ef3, org.springframework.security.web.authentication.logout.LogoutFilter@3d805670, com.example.referral.security.JwtRequestFilter@4824d077, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@23ac164d, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@451e8bd0, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@4af32714, org.springframework.security.web.session.SessionManagementFilter@8b814b, org.springframework.security.web.access.ExceptionTranslationFilter@2baf2c6, org.springframework.security.web.access.intercept.AuthorizationFilter@8b329ae]
2025-06-10 02:17:08,106 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 02:17:08,114 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path '/api/v1'
2025-06-10 02:17:08,124 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 2.979 seconds (process running for 3.332)
2025-06-10 02:17:08,634 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 02:17:08,634 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 02:17:08,636 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 2 ms
2025-06-10 02:22:27,175 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:22:27,178 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists profiles cascade 
2025-06-10 02:22:27,181 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists referral cascade 
2025-06-10 02:22:27,181 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists users cascade 
2025-06-10 02:22:27,184 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 02:22:27,187 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 02:25:43,621 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 02:25:43,636 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 18555 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 02:25:43,636 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 02:25:43,636 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 02:25:44,144 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 02:25:44,168 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 02:25:44,539 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 02:25:44,544 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 02:25:44,544 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 02:25:44,545 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 02:25:44,565 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 02:25:44,565 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 906 ms
2025-06-10 02:25:44,647 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 02:25:44,737 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 02:25:44,738 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 02:25:44,744 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 02:25:44,839 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 02:25:44,866 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 02:25:44,881 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 02:25:44,988 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 02:25:45,009 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 02:25:45,442 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 02:25:45,448 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profiles cascade 
2025-06-10 02:25:45,450 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:25:45,450 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:25:45,452 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profiles (
        dob date not null,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 02:25:45,457 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint not null,
        updated_at timestamp(6),
        status varchar(255) not null check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 02:25:45,459 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 02:25:45,460 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profiles 
       add constraint FK410q61iev7klncmpqfuo85ivh 
       foreign key (user_id) 
       references users
2025-06-10 02:25:45,464 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 02:25:45,465 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 02:25:45,467 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:25:45,682 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 02:25:45,872 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 02:25:46,147 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 02:25:46,200 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@1dd1093c, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@57bd0b3c, org.springframework.security.web.context.SecurityContextHolderFilter@2778f3d1, org.springframework.security.web.header.HeaderWriterFilter@489ec791, org.springframework.web.filter.CorsFilter@10164e94, org.springframework.security.web.authentication.logout.LogoutFilter@5ac25491, com.example.referral.security.JwtRequestFilter@2ee949d4, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5503e208, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@42ae0fcf, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@24e63b9f, org.springframework.security.web.session.SessionManagementFilter@7e4f5062, org.springframework.security.web.access.ExceptionTranslationFilter@2a62384, org.springframework.security.web.access.intercept.AuthorizationFilter@48b53f3d]
2025-06-10 02:25:46,524 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 02:25:46,531 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path '/api/v1'
2025-06-10 02:25:46,540 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.168 seconds (process running for 3.833)
2025-06-10 02:25:47,108 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(1)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 02:25:47,110 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 02:25:47,111 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 02:26:18,291 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:26:18,293 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists profiles cascade 
2025-06-10 02:26:18,299 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists referral cascade 
2025-06-10 02:26:18,299 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists users cascade 
2025-06-10 02:26:18,302 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 02:26:18,304 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 02:26:20,424 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 02:26:20,438 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 18576 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 02:26:20,438 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 02:26:20,438 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 02:26:20,938 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 02:26:20,961 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 02:26:21,317 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 02:26:21,321 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 02:26:21,322 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 02:26:21,322 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 02:26:21,343 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 02:26:21,343 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 882 ms
2025-06-10 02:26:21,416 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 02:26:21,490 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 02:26:21,491 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 02:26:21,496 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 02:26:21,590 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 02:26:21,615 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 02:26:21,629 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 02:26:21,721 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 02:26:21,742 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 02:26:22,167 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 02:26:22,172 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profiles cascade 
2025-06-10 02:26:22,174 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:26:22,174 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:26:22,176 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profiles (
        dob date not null,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 02:26:22,180 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint not null,
        updated_at timestamp(6),
        status varchar(255) not null check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 02:26:22,183 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 02:26:22,184 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profiles 
       add constraint FK410q61iev7klncmpqfuo85ivh 
       foreign key (user_id) 
       references users
2025-06-10 02:26:22,187 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 02:26:22,188 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 02:26:22,190 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:26:22,375 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 02:26:22,562 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 02:26:22,821 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 02:26:22,857 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@56ed6e17, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@58179860, org.springframework.security.web.context.SecurityContextHolderFilter@31efe094, org.springframework.security.web.header.HeaderWriterFilter@5ca67657, org.springframework.web.filter.CorsFilter@43e55cfb, org.springframework.security.web.authentication.logout.LogoutFilter@623e578b, com.example.referral.security.JwtRequestFilter@373c367, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@466fb9be, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@1d280bab, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@582ea857, org.springframework.security.web.session.SessionManagementFilter@4dd11699, org.springframework.security.web.access.ExceptionTranslationFilter@6efa2e06, org.springframework.security.web.access.intercept.AuthorizationFilter@5031786b]
2025-06-10 02:26:23,180 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 02:26:23,187 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path '/api/v1'
2025-06-10 02:26:23,196 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 2.994 seconds (process running for 3.298)
2025-06-10 02:26:23,735 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 02:26:23,735 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 02:26:23,737 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 02:28:30,669 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:28:30,671 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists profiles cascade 
2025-06-10 02:28:30,673 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists referral cascade 
2025-06-10 02:28:30,674 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists users cascade 
2025-06-10 02:28:30,677 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 02:28:30,678 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 02:29:57,033 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 02:29:57,047 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 18643 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 02:29:57,047 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 02:29:57,047 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 02:29:57,560 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 02:29:57,584 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 02:29:57,940 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 02:29:57,945 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 02:29:57,945 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 02:29:57,946 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 02:29:57,966 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 02:29:57,966 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 897 ms
2025-06-10 02:29:58,041 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 02:29:58,124 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 02:29:58,124 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 02:29:58,130 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 02:29:58,220 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 02:29:58,250 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 02:29:58,264 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 02:29:58,366 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 02:29:58,386 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 02:29:58,804 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 02:29:58,810 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profiles cascade 
2025-06-10 02:29:58,811 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:29:58,812 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:29:58,814 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profiles (
        dob date not null,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 02:29:58,819 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint not null,
        updated_at timestamp(6),
        status varchar(255) not null check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 02:29:58,821 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 02:29:58,822 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profiles 
       add constraint FK410q61iev7klncmpqfuo85ivh 
       foreign key (user_id) 
       references users
2025-06-10 02:29:58,826 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 02:29:58,827 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 02:29:58,829 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:29:59,015 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 02:29:59,206 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 02:29:59,454 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 02:29:59,500 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@7d91e9c9, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1d9db780, org.springframework.security.web.context.SecurityContextHolderFilter@5a7e0d68, org.springframework.security.web.header.HeaderWriterFilter@d69fd7a, org.springframework.web.filter.CorsFilter@759fe679, org.springframework.security.web.authentication.logout.LogoutFilter@716a6343, com.example.referral.security.JwtRequestFilter@13617139, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@24a38ef3, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@12bb3666, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@7056cda8, org.springframework.security.web.session.SessionManagementFilter@2a62384, org.springframework.security.web.access.ExceptionTranslationFilter@55a4a0ab, org.springframework.security.web.access.intercept.AuthorizationFilter@5b115d71]
2025-06-10 02:29:59,832 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 02:29:59,839 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path '/api/v1'
2025-06-10 02:29:59,848 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.05 seconds (process running for 3.358)
2025-06-10 02:30:00,360 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(1)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 02:30:00,360 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 02:30:00,361 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 02:31:07,276 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:31:07,278 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists profiles cascade 
2025-06-10 02:31:07,280 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists referral cascade 
2025-06-10 02:31:07,281 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists users cascade 
2025-06-10 02:31:07,284 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 02:31:07,286 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 02:31:09,376 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 02:31:09,393 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 18674 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 02:31:09,393 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 02:31:09,393 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 02:31:09,882 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 02:31:09,906 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 21 ms. Found 3 JPA repository interfaces.
2025-06-10 02:31:10,258 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 02:31:10,262 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 02:31:10,263 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 02:31:10,263 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 02:31:10,283 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 02:31:10,283 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 865 ms
2025-06-10 02:31:10,354 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 02:31:10,428 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 02:31:10,428 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 02:31:10,433 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 02:31:10,524 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 02:31:10,550 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 02:31:10,567 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 02:31:10,658 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 02:31:10,677 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 02:31:11,083 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 02:31:11,088 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profiles cascade 
2025-06-10 02:31:11,090 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:31:11,090 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:31:11,093 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profiles (
        dob date not null,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 02:31:11,097 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint not null,
        updated_at timestamp(6),
        status varchar(255) not null check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 02:31:11,099 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 02:31:11,100 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profiles 
       add constraint FK410q61iev7klncmpqfuo85ivh 
       foreign key (user_id) 
       references users
2025-06-10 02:31:11,104 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 02:31:11,105 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 02:31:11,107 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:31:11,291 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 02:31:11,479 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 02:31:11,724 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 02:31:11,760 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@62a193e0, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@489ec791, org.springframework.security.web.context.SecurityContextHolderFilter@2822ee4b, org.springframework.security.web.header.HeaderWriterFilter@2acb6c9a, org.springframework.web.filter.CorsFilter@3597174b, org.springframework.security.web.authentication.logout.LogoutFilter@4dd11699, com.example.referral.security.JwtRequestFilter@3c0becae, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@db9ecd, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@38e1442a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@24a38ef3, org.springframework.security.web.session.SessionManagementFilter@62e7e3df, org.springframework.security.web.access.ExceptionTranslationFilter@50cfe725, org.springframework.security.web.access.intercept.AuthorizationFilter@76b5b1e2]
2025-06-10 02:31:12,086 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 02:31:12,093 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path '/api/v1'
2025-06-10 02:31:12,102 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 2.952 seconds (process running for 3.256)
2025-06-10 02:31:12,665 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(1)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 02:31:12,665 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 02:31:12,666 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 02:32:17,773 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:32:17,775 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists profiles cascade 
2025-06-10 02:32:17,778 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists referral cascade 
2025-06-10 02:32:17,779 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists users cascade 
2025-06-10 02:32:17,782 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 02:32:17,784 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 02:32:19,974 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 02:32:19,988 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 18697 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 02:32:19,989 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 02:32:19,989 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 02:32:20,470 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 02:32:20,495 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 22 ms. Found 3 JPA repository interfaces.
2025-06-10 02:32:20,884 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 02:32:20,889 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 02:32:20,890 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 02:32:20,890 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 02:32:20,913 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 02:32:20,913 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 902 ms
2025-06-10 02:32:20,993 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 02:32:21,071 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 02:32:21,075 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 02:32:21,080 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 02:32:21,172 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 02:32:21,197 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 02:32:21,210 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 02:32:21,302 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 02:32:21,321 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 02:32:21,735 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 02:32:21,741 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profiles cascade 
2025-06-10 02:32:21,743 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 02:32:21,743 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 02:32:21,745 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profiles (
        dob date not null,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 02:32:21,749 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint not null,
        updated_at timestamp(6),
        status varchar(255) not null check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 02:32:21,752 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 02:32:21,753 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profiles 
       add constraint FK410q61iev7klncmpqfuo85ivh 
       foreign key (user_id) 
       references users
2025-06-10 02:32:21,757 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 02:32:21,758 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 02:32:21,760 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:32:21,943 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 02:32:22,132 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 02:32:22,394 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 02:32:22,437 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@414a3c7d, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@623e578b, org.springframework.security.web.context.SecurityContextHolderFilter@2531049f, org.springframework.security.web.header.HeaderWriterFilter@6259f18e, org.springframework.web.filter.CorsFilter@aad1270, org.springframework.security.web.authentication.logout.LogoutFilter@74a121fe, com.example.referral.security.JwtRequestFilter@294aaa6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@63a6dffd, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@29483d10, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@7e64b248, org.springframework.security.web.session.SessionManagementFilter@4057babc, org.springframework.security.web.access.ExceptionTranslationFilter@3ad9f06a, org.springframework.security.web.access.intercept.AuthorizationFilter@1c71d704]
2025-06-10 02:32:22,757 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 02:32:22,765 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path '/api/v1'
2025-06-10 02:32:22,773 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.062 seconds (process running for 3.375)
2025-06-10 02:32:23,265 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 02:32:23,265 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 02:32:23,267 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 2 ms
2025-06-10 02:35:19,508 INFO o.s.a.AbstractOpenApiResource [http-nio-8080-exec-7] Init duration for springdoc-openapi is: 213 ms
2025-06-10 02:37:26,735 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 02:37:26,739 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists profiles cascade 
2025-06-10 02:37:26,741 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists referral cascade 
2025-06-10 02:37:26,742 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists users cascade 
2025-06-10 02:37:26,744 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 02:37:26,745 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 19:58:11,080 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 19:58:11,096 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 19515 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 19:58:11,096 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 19:58:11,097 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 19:58:11,669 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 19:58:11,692 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 19:58:12,063 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 19:58:12,068 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 19:58:12,069 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 19:58:12,069 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 19:58:12,093 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 19:58:12,093 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 972 ms
2025-06-10 19:58:12,173 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 19:58:12,256 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 19:58:12,257 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 19:58:12,262 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 19:58:12,365 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 19:58:12,392 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 19:58:12,407 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 19:58:12,516 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 19:58:12,538 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 19:58:12,965 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 19:58:12,971 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profiles cascade 
2025-06-10 19:58:12,973 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 19:58:12,973 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 19:58:12,975 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profiles (
        dob date not null,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 19:58:12,979 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint not null,
        updated_at timestamp(6),
        status varchar(255) not null check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 19:58:12,982 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 19:58:12,983 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profiles 
       add constraint FK410q61iev7klncmpqfuo85ivh 
       foreign key (user_id) 
       references users
2025-06-10 19:58:12,987 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 19:58:12,988 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 19:58:12,990 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 19:58:13,184 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 19:58:13,368 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 19:58:13,626 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 19:58:13,665 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@11b5b1f2, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@2eb95662, org.springframework.security.web.context.SecurityContextHolderFilter@58cd7486, org.springframework.security.web.header.HeaderWriterFilter@6999dca2, org.springframework.web.filter.CorsFilter@4d87553b, org.springframework.security.web.authentication.logout.LogoutFilter@6efa2e06, com.example.referral.security.JwtRequestFilter@e10809f, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@581661d6, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6d1a4522, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@31efe094, org.springframework.security.web.session.SessionManagementFilter@50cfe725, org.springframework.security.web.access.ExceptionTranslationFilter@7c8ecc27, org.springframework.security.web.access.intercept.AuthorizationFilter@5066a895]
2025-06-10 19:58:13,989 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 19:58:13,996 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path '/api/v1'
2025-06-10 19:58:14,005 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.18 seconds (process running for 3.6)
2025-06-10 19:58:14,186 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 19:58:14,187 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 19:58:14,188 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:00:30,274 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:00:30,282 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists profiles cascade 
2025-06-10 20:00:30,288 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists referral cascade 
2025-06-10 20:00:30,289 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists users cascade 
2025-06-10 20:00:30,294 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:00:30,299 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:00:32,011 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:00:32,027 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 19621 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:00:32,028 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:00:32,028 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:00:32,560 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:00:32,583 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 20:00:32,955 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:00:32,959 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:00:32,960 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:00:32,960 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:00:32,981 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:00:32,981 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 928 ms
2025-06-10 20:00:33,053 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:00:33,136 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:00:33,136 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:00:33,142 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:00:33,234 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:00:33,264 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:00:33,279 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:00:33,381 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:00:33,401 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:00:33,818 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:00:33,823 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists profiles cascade 
2025-06-10 20:00:33,825 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists referral cascade 
2025-06-10 20:00:33,825 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    drop table if exists users cascade 
2025-06-10 20:00:33,828 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table profiles (
        dob date not null,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        user_id bigint not null unique,
        state varchar(50) not null,
        city varchar(100) not null,
        street varchar(200) not null,
        phone_number varchar(255) not null,
        zip_code varchar(255) not null,
        primary key (id)
    )
2025-06-10 20:00:33,832 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table referral (
        created_at timestamp(6),
        id bigint generated by default as identity,
        referee_id bigint,
        referrer_id bigint not null,
        updated_at timestamp(6),
        status varchar(255) not null check (status in ('PENDING','COMPLETED')),
        primary key (id)
    )
2025-06-10 20:00:33,834 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    create table users (
        referral_points integer,
        created_at timestamp(6),
        id bigint generated by default as identity,
        updated_at timestamp(6),
        name varchar(100) not null,
        email varchar(255) not null unique,
        password varchar(255) not null,
        referral_code varchar(255) not null unique,
        primary key (id)
    )
2025-06-10 20:00:33,835 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists profiles 
       add constraint FK410q61iev7klncmpqfuo85ivh 
       foreign key (user_id) 
       references users
2025-06-10 20:00:33,839 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FK4aes5wp8k5dwq8l3ofolese5h 
       foreign key (referee_id) 
       references users
2025-06-10 20:00:33,840 DEBUG o.h.e.j.s.SqlStatementLogger [main] 
    alter table if exists referral 
       add constraint FKqkdyggge1nd303oh19lcwix65 
       foreign key (referrer_id) 
       references users
2025-06-10 20:00:33,842 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:00:34,034 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:00:34,225 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:00:34,474 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:00:34,523 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@347c7b, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@126f428e, org.springframework.security.web.context.SecurityContextHolderFilter@14404be2, org.springframework.security.web.header.HeaderWriterFilter@3abe8714, org.springframework.web.filter.CorsFilter@201a84e1, org.springframework.security.web.authentication.logout.LogoutFilter@6f0124b5, com.example.referral.security.JwtRequestFilter@4548bfc7, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@13b409bb, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@601c953c, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@414a3c7d, org.springframework.security.web.session.SessionManagementFilter@274de4bc, org.springframework.security.web.access.ExceptionTranslationFilter@72cb5d7d, org.springframework.security.web.access.intercept.AuthorizationFilter@41a372c1]
2025-06-10 20:00:34,844 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:00:34,851 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path '/api/v1'
2025-06-10 20:00:34,860 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.112 seconds (process running for 3.546)
2025-06-10 20:00:35,145 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:00:35,146 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:00:35,149 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 3 ms
2025-06-10 20:02:44,958 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:02:44,960 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists profiles cascade 
2025-06-10 20:02:44,966 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists referral cascade 
2025-06-10 20:02:44,966 DEBUG o.h.e.j.s.SqlStatementLogger [SpringApplicationShutdownHook] 
    drop table if exists users cascade 
2025-06-10 20:02:44,969 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:02:44,971 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:02:46,443 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:02:46,457 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 19659 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:02:46,457 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:02:46,457 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:02:46,954 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:02:46,978 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 21 ms. Found 3 JPA repository interfaces.
2025-06-10 20:02:47,330 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:02:47,335 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:02:47,335 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:02:47,336 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:02:47,358 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:02:47,358 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 878 ms
2025-06-10 20:02:47,428 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:02:47,502 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:02:47,507 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:02:47,512 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:02:47,599 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:02:47,626 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:02:47,640 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:02:47,731 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:02:47,750 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:02:48,157 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:02:48,179 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:02:48,364 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:02:48,556 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:02:48,807 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:02:48,855 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@13b012, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@2f4a89fa, org.springframework.security.web.context.SecurityContextHolderFilter@3a5812dc, org.springframework.security.web.header.HeaderWriterFilter@648ec9f4, org.springframework.web.filter.CorsFilter@7a337217, org.springframework.security.web.authentication.logout.LogoutFilter@f341e3c, com.example.referral.security.JwtRequestFilter@d9ff1cd, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@9760f17, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@75be6796, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@45c3cf0c, org.springframework.security.web.session.SessionManagementFilter@59df8444, org.springframework.security.web.access.ExceptionTranslationFilter@7aafac17, org.springframework.security.web.access.intercept.AuthorizationFilter@5fe1b8d2]
2025-06-10 20:02:49,172 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:02:49,179 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:02:49,188 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 2.965 seconds (process running for 3.4)
2025-06-10 20:02:49,590 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(1)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:02:49,591 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:02:49,592 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:08:27,539 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:08:27,550 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:08:27,552 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:08:30,813 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:08:30,829 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 19824 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:08:30,830 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:08:30,830 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:08:31,386 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:08:31,414 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 24 ms. Found 3 JPA repository interfaces.
2025-06-10 20:08:31,817 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:08:31,822 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:08:31,824 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:08:31,824 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:08:31,849 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:08:31,849 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 994 ms
2025-06-10 20:08:31,927 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:08:32,016 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:08:32,018 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:08:32,025 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:08:32,138 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:08:32,169 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:08:32,185 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:08:32,303 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:08:32,327 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:08:32,765 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:08:32,790 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:08:33,040 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:08:33,249 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:08:33,530 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:08:33,571 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6fe47be, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@4baf3987, org.springframework.security.web.context.SecurityContextHolderFilter@7ddf7e77, org.springframework.security.web.header.HeaderWriterFilter@260d878a, org.springframework.web.filter.CorsFilter@7fef485d, org.springframework.security.web.authentication.logout.LogoutFilter@962e03a, com.example.referral.security.JwtRequestFilter@8fd3eee, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1b3639a1, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6bed8d98, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@53a4637c, org.springframework.security.web.session.SessionManagementFilter@3eff5c32, org.springframework.security.web.access.ExceptionTranslationFilter@62ee32c6, org.springframework.security.web.access.intercept.AuthorizationFilter@1160c54b]
2025-06-10 20:08:33,911 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:08:33,922 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:08:33,932 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.377 seconds (process running for 3.73)
2025-06-10 20:08:34,619 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:08:34,620 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:08:34,621 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:08:43,036 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 20:08:43,114 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Attempting to register new user with email: test@example.com
2025-06-10 20:08:43,236 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully registered new user with email: test@example.com refered by john.doe@example.com
2025-06-10 20:09:18,789 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to authenticate user: test@example.com
2025-06-10 20:10:08,017 DEBUG c.e.r.s.UserService [http-nio-8080-exec-4] Attempting to authenticate user: test@example.com
2025-06-10 20:20:02,543 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:20:02,574 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:20:02,579 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:20:05,628 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:20:05,646 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 20087 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:20:05,646 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:20:05,646 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:20:06,178 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:20:06,202 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 20:20:06,569 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:20:06,574 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:20:06,575 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:20:06,575 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:20:06,594 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:20:06,595 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 923 ms
2025-06-10 20:20:06,665 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:20:06,749 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:20:06,750 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:20:06,755 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:20:06,846 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:20:06,877 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:20:06,891 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:20:06,992 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:20:07,012 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:20:07,460 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:20:07,482 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:20:07,669 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:20:07,863 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:20:08,107 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:20:08,157 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5034e0c6, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@b88d294, org.springframework.security.web.context.SecurityContextHolderFilter@69eb88a7, org.springframework.security.web.header.HeaderWriterFilter@51f714d1, org.springframework.web.filter.CorsFilter@1cd50433, org.springframework.security.web.authentication.logout.LogoutFilter@7bb50de0, com.example.referral.security.JwtRequestFilter@162c89ac, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@34e785db, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@59df8444, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@71bbbb9f, org.springframework.security.web.session.SessionManagementFilter@69abff1d, org.springframework.security.web.access.ExceptionTranslationFilter@54422189, org.springframework.security.web.access.intercept.AuthorizationFilter@25727f74]
2025-06-10 20:20:08,475 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:20:08,483 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:20:08,492 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.108 seconds (process running for 3.495)
2025-06-10 20:20:08,838 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:20:08,838 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:20:08,841 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 3 ms
2025-06-10 20:20:22,015 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 20:20:22,100 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Attempting to register new user with email: test@example.com
2025-06-10 20:21:36,874 DEBUG c.e.r.s.UserService [http-nio-8080-exec-4] Finding user by referral code: ABC123
2025-06-10 20:21:36,883 INFO c.e.r.s.UserService [http-nio-8080-exec-4] Attempting to register new user with email: test@example.com
2025-06-10 20:21:41,251 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:21:41,259 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:21:41,262 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:21:42,844 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:21:42,860 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 20215 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:21:42,860 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:21:42,861 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:21:43,398 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:21:43,423 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 21 ms. Found 3 JPA repository interfaces.
2025-06-10 20:21:43,791 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:21:43,796 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:21:43,797 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:21:43,797 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:21:43,817 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:21:43,817 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 933 ms
2025-06-10 20:21:43,888 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:21:43,972 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:21:43,973 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:21:43,978 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:21:44,072 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:21:44,102 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:21:44,117 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:21:44,220 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:21:44,240 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:21:44,663 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:21:44,686 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:21:44,888 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:21:45,080 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:21:45,339 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:21:45,379 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@106a6420, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@60a54ad2, org.springframework.security.web.context.SecurityContextHolderFilter@1b3639a1, org.springframework.security.web.header.HeaderWriterFilter@4603845b, org.springframework.web.filter.CorsFilter@5fe1b8d2, org.springframework.security.web.authentication.logout.LogoutFilter@6193340e, com.example.referral.security.JwtRequestFilter@489a722d, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1e9d5d79, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@10014459, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@597ef918, org.springframework.security.web.session.SessionManagementFilter@48446968, org.springframework.security.web.access.ExceptionTranslationFilter@3fcc58f8, org.springframework.security.web.access.intercept.AuthorizationFilter@6fe47be]
2025-06-10 20:21:45,697 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:21:45,704 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:21:45,713 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.123 seconds (process running for 3.544)
2025-06-10 20:21:46,073 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:21:46,073 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:21:46,076 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 3 ms
2025-06-10 20:21:53,853 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 20:21:53,925 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Attempting to register new user with email: test@example.com
2025-06-10 20:22:08,668 DEBUG c.e.r.s.UserService [http-nio-8080-exec-4] Attempting to login user: test@example.com
2025-06-10 20:23:04,106 DEBUG c.e.r.s.UserService [http-nio-8080-exec-6] Attempting to login user: test@example.com
2025-06-10 20:23:31,087 INFO c.e.r.s.UserService [http-nio-8080-exec-7] Attempting to register new user with email: test1@example.com
2025-06-10 20:23:32,141 INFO c.e.r.s.UserService [http-nio-8080-exec-10] Attempting to register new user with email: test1@example.com
2025-06-10 20:26:26,318 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:26:26,330 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:26:26,333 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:26:28,773 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:26:28,791 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 20320 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:26:28,792 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:26:28,792 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:26:29,320 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:26:29,346 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 22 ms. Found 3 JPA repository interfaces.
2025-06-10 20:26:29,717 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:26:29,722 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:26:29,722 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:26:29,722 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:26:29,743 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:26:29,743 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 925 ms
2025-06-10 20:26:29,814 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:26:29,897 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:26:29,898 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:26:29,903 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:26:29,994 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:26:30,024 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:26:30,039 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:26:30,139 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:26:30,159 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:26:30,609 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:26:30,632 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:26:30,825 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:26:31,017 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:26:31,284 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:26:31,352 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@15c27b65, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@106a6420, org.springframework.security.web.context.SecurityContextHolderFilter@5a720cdf, org.springframework.security.web.header.HeaderWriterFilter@13190355, org.springframework.web.filter.CorsFilter@60a54ad2, org.springframework.security.web.authentication.logout.LogoutFilter@5f3fa154, com.example.referral.security.JwtRequestFilter@162c89ac, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@59df8444, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@495c3d15, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5fe1b8d2, org.springframework.security.web.session.SessionManagementFilter@79d538c1, org.springframework.security.web.access.ExceptionTranslationFilter@5b1c4b48, org.springframework.security.web.access.intercept.AuthorizationFilter@71bbbb9f]
2025-06-10 20:26:31,726 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:26:31,734 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:26:31,743 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.225 seconds (process running for 3.567)
2025-06-10 20:26:32,016 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:26:32,016 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:26:32,018 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 2 ms
2025-06-10 20:26:40,285 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 20:26:40,292 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 20:26:40,382 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Attempting to register new user with email: test@example.com
2025-06-10 20:30:36,799 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:30:36,807 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:30:36,809 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:30:40,074 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:30:40,088 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 20403 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:30:40,088 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:30:40,089 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:30:40,580 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:30:40,602 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 20:30:40,961 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:30:40,965 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:30:40,965 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:30:40,966 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:30:40,985 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:30:40,985 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 870 ms
2025-06-10 20:30:41,055 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:30:41,130 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:30:41,131 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:30:41,136 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:30:41,228 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:30:41,255 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:30:41,269 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:30:41,360 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:30:41,379 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:30:41,791 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:30:41,813 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:30:42,001 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:30:42,194 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:30:42,440 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:30:42,485 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5fe1b8d2, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@597ef918, org.springframework.security.web.context.SecurityContextHolderFilter@59294447, org.springframework.security.web.header.HeaderWriterFilter@3054551f, org.springframework.web.filter.CorsFilter@1af6cd73, org.springframework.security.web.authentication.logout.LogoutFilter@158774d3, com.example.referral.security.JwtRequestFilter@6f526f91, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4eb5cdae, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3ddec942, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@50cfe725, org.springframework.security.web.session.SessionManagementFilter@2db15764, org.springframework.security.web.access.ExceptionTranslationFilter@424c8ebe, org.springframework.security.web.access.intercept.AuthorizationFilter@7fef485d]
2025-06-10 20:30:42,823 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:30:42,830 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:30:42,839 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 2.988 seconds (process running for 3.305)
2025-06-10 20:30:43,417 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:30:43,418 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:30:43,419 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:30:55,363 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 20:30:55,370 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Attempting to register new user with email: test@example.com
2025-06-10 20:30:55,545 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 20:33:44,961 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:33:44,969 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:33:44,972 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:33:47,540 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:33:47,557 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 20492 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:33:47,557 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:33:47,557 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:33:48,096 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:33:48,122 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 23 ms. Found 3 JPA repository interfaces.
2025-06-10 20:33:48,485 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:33:48,490 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:33:48,491 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:33:48,491 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:33:48,511 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:33:48,511 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 928 ms
2025-06-10 20:33:48,585 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:33:48,668 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:33:48,669 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:33:48,674 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:33:48,766 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:33:48,795 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:33:48,810 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:33:48,912 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:33:48,933 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:33:49,349 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:33:49,371 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:33:49,563 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:33:49,754 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:33:50,003 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:33:50,042 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6fe47be, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@4baf3987, org.springframework.security.web.context.SecurityContextHolderFilter@7ddf7e77, org.springframework.security.web.header.HeaderWriterFilter@260d878a, org.springframework.web.filter.CorsFilter@7fef485d, org.springframework.security.web.authentication.logout.LogoutFilter@962e03a, com.example.referral.security.JwtRequestFilter@162c89ac, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1b3639a1, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6bed8d98, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@53a4637c, org.springframework.security.web.session.SessionManagementFilter@3eff5c32, org.springframework.security.web.access.ExceptionTranslationFilter@62ee32c6, org.springframework.security.web.access.intercept.AuthorizationFilter@1160c54b]
2025-06-10 20:33:50,372 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:33:50,379 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:33:50,388 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.148 seconds (process running for 3.504)
2025-06-10 20:33:50,739 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:33:50,739 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:33:50,742 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 2 ms
2025-06-10 20:34:08,013 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 20:34:08,023 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Attempting to register new user with email: test@example.com
2025-06-10 20:34:36,759 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:34:36,783 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:34:36,792 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:34:38,986 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:34:39,000 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 20523 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:34:39,000 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:34:39,000 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:34:39,484 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:34:39,509 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 20:34:39,860 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:34:39,864 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:34:39,865 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:34:39,865 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:34:39,885 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:34:39,885 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 857 ms
2025-06-10 20:34:39,958 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:34:40,036 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:34:40,037 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:34:40,042 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:34:40,128 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:34:40,153 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:34:40,167 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:34:40,258 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:34:40,277 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:34:40,693 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:34:40,715 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:34:40,899 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:34:41,089 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:34:41,332 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:34:41,378 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@27131d01, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@15c27b65, org.springframework.security.web.context.SecurityContextHolderFilter@59294447, org.springframework.security.web.header.HeaderWriterFilter@3054551f, org.springframework.web.filter.CorsFilter@106a6420, org.springframework.security.web.authentication.logout.LogoutFilter@1bc6a43c, com.example.referral.security.JwtRequestFilter@162c89ac, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4eb5cdae, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3ddec942, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@60a54ad2, org.springframework.security.web.session.SessionManagementFilter@2db15764, org.springframework.security.web.access.ExceptionTranslationFilter@424c8ebe, org.springframework.security.web.access.intercept.AuthorizationFilter@1cd50433]
2025-06-10 20:34:41,696 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:34:41,703 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:34:41,712 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 2.949 seconds (process running for 3.246)
2025-06-10 20:34:42,287 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:34:42,287 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:34:42,288 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:34:45,811 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 20:34:45,816 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 20:34:45,893 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Attempting to register new user with email: test@example.com
2025-06-10 20:37:37,336 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:37:37,351 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:37:37,355 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:37:40,903 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:37:40,919 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 20677 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:37:40,919 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:37:40,919 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:37:41,430 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:37:41,453 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 20:37:41,828 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:37:41,833 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:37:41,834 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:37:41,834 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:37:41,853 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:37:41,853 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 912 ms
2025-06-10 20:37:41,926 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:37:42,008 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:37:42,009 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:37:42,014 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:37:42,108 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:37:42,139 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:37:42,153 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:37:42,258 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:37:42,278 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:37:42,633 INFO o.h.m.i.EntityInstantiatorPojoStandard [main] HHH000182: No default (no-argument) constructor for class: com.example.referral.model.User (class must be instantiated by Interceptor)
2025-06-10 20:37:42,701 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:37:42,725 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:37:42,945 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:37:43,126 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:37:43,374 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:37:43,415 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@106a6420, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@60a54ad2, org.springframework.security.web.context.SecurityContextHolderFilter@1b3639a1, org.springframework.security.web.header.HeaderWriterFilter@4603845b, org.springframework.web.filter.CorsFilter@5fe1b8d2, org.springframework.security.web.authentication.logout.LogoutFilter@6193340e, com.example.referral.security.JwtRequestFilter@3448a248, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1e9d5d79, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@10014459, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@597ef918, org.springframework.security.web.session.SessionManagementFilter@48446968, org.springframework.security.web.access.ExceptionTranslationFilter@3fcc58f8, org.springframework.security.web.access.intercept.AuthorizationFilter@6fe47be]
2025-06-10 20:37:43,748 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:37:43,758 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:37:43,767 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.104 seconds (process running for 3.441)
2025-06-10 20:37:44,269 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:37:44,270 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:37:44,272 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:37:59,666 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 20:37:59,672 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Starting signup process for email: test@example.com
2025-06-10 20:37:59,673 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Processing referral code: ABC123
2025-06-10 20:37:59,673 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 20:37:59,761 ERROR c.e.r.s.UserService [http-nio-8080-exec-2] Error finding referrer with code ABC123: No default constructor for entity 'com.example.referral.model.User'
2025-06-10 20:37:59,761 ERROR c.e.r.s.UserService [http-nio-8080-exec-2] Error during signup for email test@example.com: Invalid referral code: ABC123
java.lang.RuntimeException: Invalid referral code: ABC123
	at com.example.referral.service.UserService.signup(UserService.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at io.micrometer.core.aop.TimedAspect.processWithTimer(TimedAspect.java:227)
	at io.micrometer.core.aop.TimedAspect.perform(TimedAspect.java:202)
	at io.micrometer.core.aop.TimedAspect.timedMethod(TimedAspect.java:194)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:637)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:627)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:71)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:385)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.example.referral.service.UserService$$SpringCGLIB$$0.signup(<generated>)
	at com.example.referral.controller.UserController.signup(UserController.java:41)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:259)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:192)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:920)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:830)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:53)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 20:39:25,182 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:39:25,191 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:39:25,193 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:39:27,689 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:39:27,706 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 20731 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:39:27,706 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:39:27,706 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:39:28,202 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:39:28,226 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 20:39:28,574 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:39:28,579 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:39:28,579 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:39:28,579 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:39:28,599 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:39:28,600 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 870 ms
2025-06-10 20:39:28,671 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:39:28,745 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:39:28,746 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:39:28,752 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:39:28,843 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:39:28,869 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:39:28,882 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:39:28,971 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:39:28,991 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:39:29,413 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:39:29,436 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:39:29,626 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:39:29,812 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:39:30,079 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:39:30,123 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@1160c54b, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@363b7709, org.springframework.security.web.context.SecurityContextHolderFilter@79d538c1, org.springframework.security.web.header.HeaderWriterFilter@7bb3cbb4, org.springframework.web.filter.CorsFilter@5034e0c6, org.springframework.security.web.authentication.logout.LogoutFilter@4dcdc172, com.example.referral.security.JwtRequestFilter@6d398b6c, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7ddf7e77, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@1377af49, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@b88d294, org.springframework.security.web.session.SessionManagementFilter@648ec9f4, org.springframework.security.web.access.ExceptionTranslationFilter@6a53cddc, org.springframework.security.web.access.intercept.AuthorizationFilter@aba4a33]
2025-06-10 20:39:30,451 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:39:30,459 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:39:30,468 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.009 seconds (process running for 3.33)
2025-06-10 20:39:31,009 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(1)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:39:31,010 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:39:31,011 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:39:34,596 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 20:39:34,601 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Starting signup process for email: test@example.com
2025-06-10 20:39:34,601 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Processing referral code: ABC123
2025-06-10 20:39:34,601 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 20:39:34,672 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Found referrer with email: john.doe@example.com
2025-06-10 20:39:34,672 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Checking if email already exists: test@example.com
2025-06-10 20:39:34,677 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Generated referral code: 5SBRX2
2025-06-10 20:39:34,678 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating new user with email: test@example.com
2025-06-10 20:39:34,771 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Saving user to database
2025-06-10 20:39:34,784 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully saved user with ID: 6
2025-06-10 20:39:34,784 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 20:39:34,789 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 20:43:25,088 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:43:25,099 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:43:25,101 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:43:28,511 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:43:28,532 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 20817 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:43:28,533 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:43:28,533 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:43:29,214 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:43:29,237 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 20:43:29,608 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:43:29,613 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:43:29,613 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:43:29,613 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:43:29,634 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:43:29,635 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1072 ms
2025-06-10 20:43:29,708 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:43:29,789 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:43:29,790 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:43:29,796 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:43:29,895 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:43:29,924 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:43:29,938 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:43:30,037 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:43:30,057 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:43:30,478 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:43:30,501 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:43:30,695 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:43:30,887 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:43:31,175 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:43:31,215 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@60a54ad2, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5fe1b8d2, org.springframework.security.web.context.SecurityContextHolderFilter@59df8444, org.springframework.security.web.header.HeaderWriterFilter@414b5798, org.springframework.web.filter.CorsFilter@597ef918, org.springframework.security.web.authentication.logout.LogoutFilter@3bced0d2, com.example.referral.security.JwtRequestFilter@7a9e44ff, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5ae06c93, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6ab56a77, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@1af6cd73, org.springframework.security.web.session.SessionManagementFilter@7ddf7e77, org.springframework.security.web.access.ExceptionTranslationFilter@51f714d1, org.springframework.security.web.access.intercept.AuthorizationFilter@4baf3987]
2025-06-10 20:43:31,537 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:43:31,545 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:43:31,554 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.506 seconds (process running for 3.847)
2025-06-10 20:43:32,148 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(1)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:43:32,149 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:43:32,151 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Completed initialization in 2 ms
2025-06-10 20:43:36,998 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 20:43:37,005 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Starting signup process for email: test@example.com
2025-06-10 20:43:37,005 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Processing referral code: ABC123
2025-06-10 20:43:37,005 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 20:43:37,077 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Found referrer with email: john.doe@example.com
2025-06-10 20:43:37,077 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Checking if email already exists: test@example.com
2025-06-10 20:43:37,083 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Generated referral code: ESQY7N
2025-06-10 20:43:37,083 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating new user with email: test@example.com
2025-06-10 20:43:37,177 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Saving user to database
2025-06-10 20:43:37,192 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully saved user with ID: 6
2025-06-10 20:43:37,192 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 20:43:37,197 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 20:43:49,161 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 20:44:18,509 DEBUG c.e.r.s.UserService [http-nio-8080-exec-5] Attempting to login user: test@example.com
2025-06-10 20:46:03,353 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:46:03,364 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:46:03,367 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:46:05,765 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:46:05,781 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 20886 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:46:05,781 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:46:05,781 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:46:06,268 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:46:06,290 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 20:46:06,645 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:46:06,650 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:46:06,650 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:46:06,650 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:46:06,671 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:46:06,671 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 861 ms
2025-06-10 20:46:06,741 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:46:06,814 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:46:06,815 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:46:06,820 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:46:06,913 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:46:06,938 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:46:06,951 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:46:07,042 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:46:07,061 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:46:07,489 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:46:07,515 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:46:07,712 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:46:07,904 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:46:08,151 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:46:08,194 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@2822ee4b, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@54a332e4, org.springframework.security.web.context.SecurityContextHolderFilter@472073bb, org.springframework.security.web.header.HeaderWriterFilter@52688730, org.springframework.web.filter.CorsFilter@1e3f0c5c, org.springframework.security.web.authentication.logout.LogoutFilter@13b012, com.example.referral.security.JwtRequestFilter@40d0bff1, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3bced0d2, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2c51ff83, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@1476e447, org.springframework.security.web.session.SessionManagementFilter@4dcdc172, org.springframework.security.web.access.ExceptionTranslationFilter@6bed8d98, org.springframework.security.web.access.intercept.AuthorizationFilter@8b814b]
2025-06-10 20:46:08,528 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:46:08,535 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:46:08,544 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.001 seconds (process running for 3.342)
2025-06-10 20:46:09,032 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:46:09,033 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:46:09,034 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:46:17,024 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 20:46:17,030 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Starting signup process for email: test@example.com
2025-06-10 20:46:17,030 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Processing referral code: ABC123
2025-06-10 20:46:17,030 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 20:46:17,102 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Found referrer with email: john.doe@example.com
2025-06-10 20:46:17,103 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Checking if email already exists: test@example.com
2025-06-10 20:46:17,110 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Generated referral code: 4GLXDM
2025-06-10 20:46:17,110 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating new user with email: test@example.com
2025-06-10 20:46:17,213 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Saving user to database
2025-06-10 20:46:17,226 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully saved user with ID: 6
2025-06-10 20:46:17,227 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 20:46:17,234 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 20:46:20,188 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 20:46:20,188 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 20:48:18,644 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:48:18,677 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:48:18,686 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:48:22,156 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:48:22,172 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 20936 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:48:22,172 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:48:22,172 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:48:22,851 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:48:22,875 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 21 ms. Found 3 JPA repository interfaces.
2025-06-10 20:48:23,264 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:48:23,272 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:48:23,273 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:48:23,274 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:48:23,319 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:48:23,319 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1060 ms
2025-06-10 20:48:23,428 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:48:23,532 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:48:23,533 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:48:23,541 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:48:23,624 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:48:23,651 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:48:23,671 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:48:23,771 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:48:23,794 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:48:24,212 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:48:24,235 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:48:24,448 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:48:24,663 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:48:24,946 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:48:24,994 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@19b89a23, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6d1a4522, org.springframework.security.web.context.SecurityContextHolderFilter@6725f9e0, org.springframework.security.web.header.HeaderWriterFilter@5a720cdf, org.springframework.web.filter.CorsFilter@1835b24b, org.springframework.security.web.authentication.logout.LogoutFilter@27df971b, com.example.referral.security.JwtRequestFilter@65145fb7, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@11a88d87, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@523cc8b4, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@303d2485, org.springframework.security.web.session.SessionManagementFilter@13cfa1ec, org.springframework.security.web.access.ExceptionTranslationFilter@7980eb2, org.springframework.security.web.access.intercept.AuthorizationFilter@2acb6c9a]
2025-06-10 20:48:25,345 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:48:25,353 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:48:25,362 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.479 seconds (process running for 3.932)
2025-06-10 20:48:25,867 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:48:25,867 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:48:25,870 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 3 ms
2025-06-10 20:48:34,627 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 20:48:34,632 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Starting signup process for email: test@example.com
2025-06-10 20:48:34,632 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Processing referral code: ABC123
2025-06-10 20:48:34,633 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 20:48:34,704 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Found referrer with email: john.doe@example.com
2025-06-10 20:48:34,704 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Checking if email already exists: test@example.com
2025-06-10 20:48:34,710 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Generated referral code: LY84SW
2025-06-10 20:48:34,710 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating new user with email: test@example.com
2025-06-10 20:48:34,805 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Saving user to database
2025-06-10 20:48:34,818 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully saved user with ID: 6
2025-06-10 20:48:34,819 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 20:48:34,825 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 20:48:37,954 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 20:48:37,954 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 20:50:36,720 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:50:36,728 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:50:36,730 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:50:39,022 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:50:39,038 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 21011 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:50:39,038 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:50:39,039 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:50:39,517 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:50:39,540 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 20:50:39,895 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:50:39,899 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:50:39,899 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:50:39,900 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:50:39,920 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:50:39,920 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 859 ms
2025-06-10 20:50:39,991 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:50:40,066 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:50:40,066 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:50:40,072 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:50:40,162 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:50:40,187 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:50:40,200 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:50:40,287 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:50:40,306 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:50:40,723 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:50:40,745 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:50:40,930 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:50:41,115 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:50:41,371 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:50:41,411 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6193340e, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3bced0d2, org.springframework.security.web.context.SecurityContextHolderFilter@1263d20d, org.springframework.security.web.header.HeaderWriterFilter@69f35d31, org.springframework.web.filter.CorsFilter@158774d3, org.springframework.security.web.authentication.logout.LogoutFilter@216a3aba, com.example.referral.security.JwtRequestFilter@4fe91eed, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3054551f, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@5ffae42f, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@37905236, org.springframework.security.web.session.SessionManagementFilter@5e435f0d, org.springframework.security.web.access.ExceptionTranslationFilter@5f8c319, org.springframework.security.web.access.intercept.AuthorizationFilter@962e03a]
2025-06-10 20:50:41,731 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:50:41,738 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:50:41,747 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 2.974 seconds (process running for 3.265)
2025-06-10 20:50:42,306 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(1)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:50:42,307 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:50:42,308 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:50:49,026 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 20:50:49,036 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Starting signup process for email: test@example.com
2025-06-10 20:50:49,036 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Processing referral code: ABC123
2025-06-10 20:50:49,036 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 20:50:49,104 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Found referrer with email: john.doe@example.com
2025-06-10 20:50:49,105 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Checking if email already exists: test@example.com
2025-06-10 20:50:49,110 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Generated referral code: DNZABV
2025-06-10 20:50:49,110 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating new user with email: test@example.com
2025-06-10 20:50:49,203 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Saving user to database
2025-06-10 20:50:49,216 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully saved user with ID: 6
2025-06-10 20:50:49,216 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 20:50:49,222 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 20:50:52,752 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 20:50:52,752 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 20:51:08,362 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:51:08,377 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:51:08,379 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:51:10,984 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:51:10,999 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 21022 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:51:10,999 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:51:10,999 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:51:11,478 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:51:11,501 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 20:51:11,856 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:51:11,860 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:51:11,861 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:51:11,861 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:51:11,881 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:51:11,882 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 860 ms
2025-06-10 20:51:11,956 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:51:12,040 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:51:12,041 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:51:12,048 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:51:12,173 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:51:12,196 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:51:12,210 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:51:12,299 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:51:12,328 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:51:12,738 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:51:12,760 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:51:12,950 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:51:13,135 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:51:13,401 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:51:13,449 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@2f4a89fa, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7a337217, org.springframework.security.web.context.SecurityContextHolderFilter@3ddec942, org.springframework.security.web.header.HeaderWriterFilter@158119bf, org.springframework.web.filter.CorsFilter@45c3cf0c, org.springframework.security.web.authentication.logout.LogoutFilter@7c8ecc27, com.example.referral.security.JwtRequestFilter@7b0d88e0, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@13cfa1ec, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@63793f16, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@58cd7486, org.springframework.security.web.session.SessionManagementFilter@4ac7f844, org.springframework.security.web.access.ExceptionTranslationFilter@3054551f, org.springframework.security.web.access.intercept.AuthorizationFilter@597ef918]
2025-06-10 20:51:13,769 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:51:13,776 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:51:13,785 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.06 seconds (process running for 3.369)
2025-06-10 20:51:14,316 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:51:14,317 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:51:14,320 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 3 ms
2025-06-10 20:53:31,112 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:53:31,141 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:53:31,152 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:53:34,673 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:53:34,687 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 21082 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:53:34,687 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:53:34,687 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:53:35,196 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:53:35,225 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 24 ms. Found 3 JPA repository interfaces.
2025-06-10 20:53:35,630 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:53:35,635 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:53:35,635 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:53:35,635 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:53:35,656 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:53:35,656 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 947 ms
2025-06-10 20:53:35,728 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:53:35,815 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:file:./referraldb user=SA
2025-06-10 20:53:35,815 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:53:35,825 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:./referraldb'
2025-06-10 20:53:35,921 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:53:35,945 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:53:35,958 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:53:36,051 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:53:36,070 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:53:36,545 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:53:36,576 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:53:36,764 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:53:36,773 WARN o.s.c.s.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'securityConfig': Unsatisfied dependency expressed through field 'userDetailsService': No qualifying bean of type 'org.springframework.security.core.userdetails.UserDetailsService' available: expected single matching bean but found 2: customUserDetailsService,userService
2025-06-10 20:53:36,773 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:53:36,775 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2025-06-10 20:53:36,790 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2025-06-10 20:53:36,791 INFO o.a.j.l.DirectJDKLog [main] Stopping service [Tomcat]
2025-06-10 20:53:36,801 INFO o.s.b.a.l.ConditionEvaluationReportLogger [main] 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-06-10 20:53:36,810 ERROR o.s.b.d.LoggingFailureAnalysisReporter [main] 

***************************
APPLICATION FAILED TO START
***************************

Description:

Field userDetailsService in com.example.referral.config.SecurityConfig required a single bean, but 2 were found:
	- customUserDetailsService: defined in file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/com/example/referral/security/CustomUserDetailsService.class]
	- userService: defined in file [/Users/arpit/Developer/SpringBoot/UserReferral/target/classes/com/example/referral/service/UserService.class]

This may be due to missing parameter name information

Action:

Consider marking one of the beans as @Primary, updating the consumer to accept multiple beans, or using @Qualifier to identify the bean that should be consumed

Ensure that your compiler is configured to use the '-parameters' flag.
You may need to update both your build tool settings as well as your IDE.
(See https://github.com/spring-projects/spring-framework/wiki/Upgrading-to-Spring-Framework-6.x#parameter-name-retention)


2025-06-10 20:56:21,583 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:56:21,597 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 21131 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:56:21,597 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:56:21,598 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:56:22,115 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:56:22,137 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 18 ms. Found 3 JPA repository interfaces.
2025-06-10 20:56:22,508 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:56:22,512 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:56:22,513 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:56:22,513 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:56:22,534 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:56:22,534 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 912 ms
2025-06-10 20:56:22,608 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:56:22,717 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:file:./referraldb user=SA
2025-06-10 20:56:22,718 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:56:22,725 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:./referraldb'
2025-06-10 20:56:22,824 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:56:22,859 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:56:22,875 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:56:22,984 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:56:23,004 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:56:23,418 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:56:23,440 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:56:23,651 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:56:23,842 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:56:24,101 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:56:24,138 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@76e14208, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6809a461, org.springframework.security.web.context.SecurityContextHolderFilter@3237522b, org.springframework.security.web.header.HeaderWriterFilter@630e5803, org.springframework.web.filter.CorsFilter@21440e36, org.springframework.security.web.authentication.logout.LogoutFilter@231c8be4, com.example.referral.security.JwtRequestFilter@5275d709, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1f94e1, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@69959ea5, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@9b87a98, org.springframework.security.web.session.SessionManagementFilter@3f976f43, org.springframework.security.web.access.ExceptionTranslationFilter@3b256d50, org.springframework.security.web.access.intercept.AuthorizationFilter@572c50b6]
2025-06-10 20:56:24,463 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:56:24,471 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:56:24,480 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.137 seconds (process running for 3.455)
2025-06-10 20:56:24,898 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:56:24,899 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:56:24,900 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:56:35,338 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 20:56:35,345 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Starting signup process for email: test@example.com
2025-06-10 20:56:35,345 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Processing referral code: ABC123
2025-06-10 20:56:35,345 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 20:56:35,407 WARN c.e.r.s.UserService [http-nio-8080-exec-2] User not found with referral code: ABC123
2025-06-10 20:56:35,407 ERROR c.e.r.s.UserService [http-nio-8080-exec-2] Error finding referrer with code ABC123: Invalid referral code
2025-06-10 20:56:35,408 ERROR c.e.r.s.UserService [http-nio-8080-exec-2] Error during signup for email test@example.com: Invalid referral code: ABC123
java.lang.RuntimeException: Invalid referral code: ABC123
	at com.example.referral.service.UserService.signup(UserService.java:63)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at io.micrometer.core.aop.TimedAspect.processWithTimer(TimedAspect.java:227)
	at io.micrometer.core.aop.TimedAspect.perform(TimedAspect.java:202)
	at io.micrometer.core.aop.TimedAspect.timedMethod(TimedAspect.java:194)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:637)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:627)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:71)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:385)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.example.referral.service.UserService$$SpringCGLIB$$0.signup(<generated>)
	at com.example.referral.controller.UserController.signup(UserController.java:41)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:259)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:192)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:920)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:830)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:53)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 20:56:55,462 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:56:55,466 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:56:55,473 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:56:57,106 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:56:57,119 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 21151 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:56:57,120 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:56:57,120 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:56:57,609 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:56:57,631 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 20:56:57,982 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:56:57,986 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:56:57,987 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:56:57,987 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:56:58,007 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:56:58,007 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 865 ms
2025-06-10 20:56:58,080 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:56:58,173 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:file:./referraldb user=SA
2025-06-10 20:56:58,174 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:56:58,179 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:./referraldb'
2025-06-10 20:56:58,279 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:56:58,301 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:56:58,314 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:56:58,406 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:56:58,424 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:56:58,842 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:56:58,864 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:56:59,053 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:56:59,236 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:56:59,491 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:56:59,528 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@58ed5ed3, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@133e7789, org.springframework.security.web.context.SecurityContextHolderFilter@127c5f20, org.springframework.security.web.header.HeaderWriterFilter@2c70da80, org.springframework.web.filter.CorsFilter@62f47cac, org.springframework.security.web.authentication.logout.LogoutFilter@4f573b84, com.example.referral.security.JwtRequestFilter@4e6881e, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1a6e940b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@53fd061d, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@7845f53d, org.springframework.security.web.session.SessionManagementFilter@630e5803, org.springframework.security.web.access.ExceptionTranslationFilter@3552eb5b, org.springframework.security.web.access.intercept.AuthorizationFilter@24a024c8]
2025-06-10 20:56:59,840 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:56:59,849 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:56:59,858 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 2.979 seconds (process running for 3.369)
2025-06-10 20:57:00,381 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:57:00,381 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:57:00,382 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:57:52,205 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:57:52,212 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:57:52,214 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:57:54,377 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:57:54,394 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 21172 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:57:54,394 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:57:54,395 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:57:54,876 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:57:54,898 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 18 ms. Found 3 JPA repository interfaces.
2025-06-10 20:57:55,256 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:57:55,260 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:57:55,261 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:57:55,261 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:57:55,281 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:57:55,282 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 864 ms
2025-06-10 20:57:55,351 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:57:55,425 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:57:55,426 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:57:55,435 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:57:55,521 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:57:55,548 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:57:55,561 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:57:55,653 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:57:55,673 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:57:56,085 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:57:56,127 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:57:56,393 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:57:56,582 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:57:56,932 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:57:56,977 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5031786b, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@40830e1e, org.springframework.security.web.context.SecurityContextHolderFilter@4dd11699, org.springframework.security.web.header.HeaderWriterFilter@63a6dffd, org.springframework.web.filter.CorsFilter@4f578fc2, org.springframework.security.web.authentication.logout.LogoutFilter@1c71d704, com.example.referral.security.JwtRequestFilter@445adbd7, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4d87553b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@50fbb66a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@26350832, org.springframework.security.web.session.SessionManagementFilter@39aa595, org.springframework.security.web.access.ExceptionTranslationFilter@7bbc3b6e, org.springframework.security.web.access.intercept.AuthorizationFilter@42ae0fcf]
2025-06-10 20:57:57,320 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:57:57,328 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:57:57,337 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.174 seconds (process running for 3.463)
2025-06-10 20:57:57,707 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:57:57,707 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:57:57,708 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:58:10,852 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 20:58:10,858 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Starting signup process for email: test@example.com
2025-06-10 20:58:10,858 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Processing referral code: ABC123
2025-06-10 20:58:10,858 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 20:58:10,946 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Found referrer with email: john.doe@example.com
2025-06-10 20:58:10,946 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Checking if email already exists: test@example.com
2025-06-10 20:58:10,952 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Generated referral code: 4W2RQ6
2025-06-10 20:58:10,953 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating new user with email: test@example.com
2025-06-10 20:58:11,045 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Saving user to database
2025-06-10 20:58:11,059 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully saved user with ID: 6
2025-06-10 20:58:11,060 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 20:58:11,067 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 20:58:18,046 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 20:58:18,056 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 20:58:18,057 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 20:58:18,269 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 20:58:18,270 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 20:58:18,271 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 20:58:18,307 ERROR c.e.r.s.UserService [http-nio-8080-exec-3] Unexpected error during login for user: test@example.com - The signing key's size is 504 bits which is not secure enough for the HS512 algorithm.  The JWT JWA Specification (RFC 7518, Section 3.2) states that keys used with HS512 MUST have a size >= 512 bits (the key size must be greater than or equal to the hash output size).  Consider using the io.jsonwebtoken.security.Keys class's 'secretKeyFor(SignatureAlgorithm.HS512)' method to create a key guaranteed to be secure enough for HS512.  See https://tools.ietf.org/html/rfc7518#section-3.2 for more information.
io.jsonwebtoken.security.WeakKeyException: The signing key's size is 504 bits which is not secure enough for the HS512 algorithm.  The JWT JWA Specification (RFC 7518, Section 3.2) states that keys used with HS512 MUST have a size >= 512 bits (the key size must be greater than or equal to the hash output size).  Consider using the io.jsonwebtoken.security.Keys class's 'secretKeyFor(SignatureAlgorithm.HS512)' method to create a key guaranteed to be secure enough for HS512.  See https://tools.ietf.org/html/rfc7518#section-3.2 for more information.
	at io.jsonwebtoken.SignatureAlgorithm.assertValid(SignatureAlgorithm.java:387)
	at io.jsonwebtoken.SignatureAlgorithm.assertValidSigningKey(SignatureAlgorithm.java:315)
	at io.jsonwebtoken.impl.DefaultJwtBuilder.signWith(DefaultJwtBuilder.java:112)
	at com.example.referral.security.JwtTokenUtil.createToken(JwtTokenUtil.java:48)
	at com.example.referral.security.JwtTokenUtil.generateToken(JwtTokenUtil.java:37)
	at com.example.referral.service.UserService.login(UserService.java:133)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at io.micrometer.core.aop.TimedAspect.processWithTimer(TimedAspect.java:227)
	at io.micrometer.core.aop.TimedAspect.perform(TimedAspect.java:202)
	at io.micrometer.core.aop.TimedAspect.timedMethod(TimedAspect.java:194)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:637)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:627)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:71)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.example.referral.service.UserService$$SpringCGLIB$$0.login(<generated>)
	at com.example.referral.controller.UserController.login(UserController.java:53)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:259)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:192)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:920)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:830)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:53)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 20:59:36,601 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:59:36,613 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 20:59:36,615 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 20:59:38,790 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 20:59:38,808 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 21230 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 20:59:38,808 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 20:59:38,809 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 20:59:39,336 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 20:59:39,361 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 21 ms. Found 3 JPA repository interfaces.
2025-06-10 20:59:39,727 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 20:59:39,732 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 20:59:39,732 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 20:59:39,732 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 20:59:39,752 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 20:59:39,752 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 919 ms
2025-06-10 20:59:39,824 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 20:59:39,908 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 20:59:39,908 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 20:59:39,914 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 20:59:40,005 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 20:59:40,035 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 20:59:40,049 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 20:59:40,153 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 20:59:40,173 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 20:59:40,593 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 20:59:40,615 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 20:59:40,810 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 20:59:41,009 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 20:59:41,256 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 20:59:41,304 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@3f46fb53, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@42ae0fcf, org.springframework.security.web.context.SecurityContextHolderFilter@39aa595, org.springframework.security.web.header.HeaderWriterFilter@1743c249, org.springframework.web.filter.CorsFilter@5e16e521, org.springframework.security.web.authentication.logout.LogoutFilter@24a38ef3, com.example.referral.security.JwtRequestFilter@f111e97, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@6eec564c, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@11b5b1f2, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@51a4472d, org.springframework.security.web.session.SessionManagementFilter@7d461450, org.springframework.security.web.access.ExceptionTranslationFilter@1476e447, org.springframework.security.web.access.intercept.AuthorizationFilter@f9b97dc]
2025-06-10 20:59:41,625 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 20:59:41,632 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 20:59:41,641 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.121 seconds (process running for 3.444)
2025-06-10 20:59:41,963 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 20:59:41,963 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 20:59:41,965 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 20:59:47,508 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 20:59:47,513 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Starting signup process for email: test@example.com
2025-06-10 20:59:47,513 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Processing referral code: ABC123
2025-06-10 20:59:47,513 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 20:59:47,579 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Found referrer with email: john.doe@example.com
2025-06-10 20:59:47,579 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Checking if email already exists: test@example.com
2025-06-10 20:59:47,585 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Generated referral code: 2ARUZW
2025-06-10 20:59:47,585 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating new user with email: test@example.com
2025-06-10 20:59:47,677 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Saving user to database
2025-06-10 20:59:47,690 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully saved user with ID: 6
2025-06-10 20:59:47,690 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 20:59:47,696 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 20:59:51,330 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 20:59:51,333 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 20:59:51,333 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 20:59:51,548 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 20:59:51,549 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 20:59:51,549 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 20:59:51,563 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 20:59:51,563 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 21:00:21,405 ERROR o.a.j.l.DirectJDKLog [http-nio-8080-exec-4] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
io.jsonwebtoken.MalformedJwtException: JWT strings must contain exactly 2 period characters. Found: 0
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:275)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at com.example.referral.security.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:70)
	at com.example.referral.security.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:62)
	at com.example.referral.security.JwtTokenUtil.getUsernameFromToken(JwtTokenUtil.java:58)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:40)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 21:00:36,336 ERROR o.a.j.l.DirectJDKLog [http-nio-8080-exec-5] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
io.jsonwebtoken.security.SignatureException: JWT signature does not match locally computed signature. JWT validity cannot be asserted and should not be trusted.
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:399)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at com.example.referral.security.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:70)
	at com.example.referral.security.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:62)
	at com.example.referral.security.JwtTokenUtil.getUsernameFromToken(JwtTokenUtil.java:58)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:40)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 21:00:45,720 ERROR o.a.j.l.DirectJDKLog [http-nio-8080-exec-6] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
io.jsonwebtoken.security.SignatureException: JWT signature does not match locally computed signature. JWT validity cannot be asserted and should not be trusted.
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:399)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at com.example.referral.security.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:70)
	at com.example.referral.security.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:62)
	at com.example.referral.security.JwtTokenUtil.getUsernameFromToken(JwtTokenUtil.java:58)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:40)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 21:02:04,152 ERROR o.a.j.l.DirectJDKLog [http-nio-8080-exec-8] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
io.jsonwebtoken.security.SignatureException: JWT signature does not match locally computed signature. JWT validity cannot be asserted and should not be trusted.
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:399)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at com.example.referral.security.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:70)
	at com.example.referral.security.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:62)
	at com.example.referral.security.JwtTokenUtil.getUsernameFromToken(JwtTokenUtil.java:58)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:40)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 21:02:27,689 ERROR o.a.j.l.DirectJDKLog [http-nio-8080-exec-10] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
io.jsonwebtoken.security.SignatureException: JWT signature does not match locally computed signature. JWT validity cannot be asserted and should not be trusted.
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:399)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at com.example.referral.security.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:70)
	at com.example.referral.security.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:62)
	at com.example.referral.security.JwtTokenUtil.getUsernameFromToken(JwtTokenUtil.java:58)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:40)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 21:02:35,253 ERROR o.a.j.l.DirectJDKLog [http-nio-8080-exec-1] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
io.jsonwebtoken.security.SignatureException: JWT signature does not match locally computed signature. JWT validity cannot be asserted and should not be trusted.
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:399)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at com.example.referral.security.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:70)
	at com.example.referral.security.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:62)
	at com.example.referral.security.JwtTokenUtil.getUsernameFromToken(JwtTokenUtil.java:58)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:40)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 21:02:46,078 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 21:02:46,091 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 21:02:46,093 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 21:02:47,704 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 21:02:47,722 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 21354 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 21:02:47,723 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 21:02:47,723 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 21:02:48,252 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 21:02:48,275 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 21:02:48,639 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 21:02:48,643 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 21:02:48,644 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 21:02:48,644 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 21:02:48,664 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 21:02:48,664 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 918 ms
2025-06-10 21:02:48,739 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 21:02:48,822 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 21:02:48,827 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 21:02:48,833 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 21:02:48,935 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 21:02:48,963 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 21:02:48,978 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 21:02:49,078 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 21:02:49,098 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 21:02:49,520 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 21:02:49,542 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 21:02:49,734 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 21:02:49,930 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 21:02:50,610 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 21:02:50,660 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@51a4472d, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5930a229, org.springframework.security.web.context.SecurityContextHolderFilter@6cad2d5f, org.springframework.security.web.header.HeaderWriterFilter@2531049f, org.springframework.web.filter.CorsFilter@6bd21eb7, org.springframework.security.web.authentication.logout.LogoutFilter@794fbf0d, com.example.referral.security.JwtRequestFilter@7b0d88e0, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4dd11699, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2eb95662, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@204d101, org.springframework.security.web.session.SessionManagementFilter@75ee63f2, org.springframework.security.web.access.ExceptionTranslationFilter@2b991034, org.springframework.security.web.access.intercept.AuthorizationFilter@5225f612]
2025-06-10 21:02:51,078 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 21:02:51,086 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 21:02:51,096 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.644 seconds (process running for 4.043)
2025-06-10 21:02:51,442 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 21:02:51,443 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 21:02:51,445 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 2 ms
2025-06-10 21:19:30,274 WARN c.z.h.p.HikariPool$HouseKeeper [HikariPool-1 housekeeper] HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=16m41s339ms).
2025-06-10 21:41:06,585 WARN c.z.h.p.HikariPool$HouseKeeper [HikariPool-1 housekeeper] HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=16m6s228ms).
2025-06-10 22:00:02,171 WARN c.z.h.p.HikariPool$HouseKeeper [HikariPool-1 housekeeper] HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=16m25s530ms).
2025-06-10 22:17:07,451 WARN c.z.h.p.HikariPool$HouseKeeper [HikariPool-1 housekeeper] HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=16m35s283ms).
2025-06-10 22:24:25,697 WARN c.z.h.p.HikariPool$HouseKeeper [HikariPool-1 housekeeper] HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=6m48s223ms).
2025-06-10 22:32:25,931 WARN c.z.h.p.HikariPool$HouseKeeper [HikariPool-1 housekeeper] HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=8m234ms).
2025-06-10 22:32:27,152 ERROR o.a.j.l.DirectJDKLog [http-nio-8080-exec-2] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
io.jsonwebtoken.security.SignatureException: JWT signature does not match locally computed signature. JWT validity cannot be asserted and should not be trusted.
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:399)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at com.example.referral.security.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:70)
	at com.example.referral.security.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:62)
	at com.example.referral.security.JwtTokenUtil.getUsernameFromToken(JwtTokenUtil.java:58)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:40)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 22:32:40,617 ERROR o.a.j.l.DirectJDKLog [http-nio-8080-exec-3] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
io.jsonwebtoken.security.SignatureException: JWT signature does not match locally computed signature. JWT validity cannot be asserted and should not be trusted.
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:399)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at com.example.referral.security.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:70)
	at com.example.referral.security.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:62)
	at com.example.referral.security.JwtTokenUtil.getUsernameFromToken(JwtTokenUtil.java:58)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:40)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 22:32:47,750 DEBUG c.e.r.s.UserService [http-nio-8080-exec-4] Attempting to login user: test@example.com
2025-06-10 22:32:47,833 ERROR c.e.r.s.UserService [http-nio-8080-exec-4] User not found with email: test@example.com
2025-06-10 22:32:47,833 ERROR c.e.r.s.UserService [http-nio-8080-exec-4] Login error for user: test@example.com - Invalid email or password
2025-06-10 22:32:55,358 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 22:32:55,370 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 22:32:55,375 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 22:32:57,032 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 22:32:57,050 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 21964 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 22:32:57,050 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 22:32:57,051 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 22:32:57,583 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 22:32:57,606 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 22:32:57,974 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 22:32:57,978 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 22:32:57,979 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 22:32:57,979 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 22:32:58,000 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 22:32:58,001 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 922 ms
2025-06-10 22:32:58,073 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 22:32:58,154 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 22:32:58,155 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 22:32:58,161 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 22:32:58,251 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 22:32:58,281 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 22:32:58,296 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 22:32:58,397 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 22:32:58,417 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 22:32:58,836 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 22:32:58,859 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 22:32:59,055 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 22:32:59,261 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 22:32:59,509 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 22:32:59,560 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5031786b, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@40830e1e, org.springframework.security.web.context.SecurityContextHolderFilter@11b5b1f2, org.springframework.security.web.header.HeaderWriterFilter@1a02063a, org.springframework.web.filter.CorsFilter@4f578fc2, org.springframework.security.web.authentication.logout.LogoutFilter@126f428e, com.example.referral.security.JwtRequestFilter@556a5e70, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1e5e0e75, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@25699129, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@26350832, org.springframework.security.web.session.SessionManagementFilter@55a4a0ab, org.springframework.security.web.access.ExceptionTranslationFilter@1743c249, org.springframework.security.web.access.intercept.AuthorizationFilter@6bd21eb7]
2025-06-10 22:32:59,877 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 22:32:59,885 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 22:32:59,893 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.113 seconds (process running for 3.531)
2025-06-10 22:33:00,177 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 22:33:00,177 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 22:33:00,178 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 22:33:05,806 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 22:33:05,811 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Starting signup process for email: test@example.com
2025-06-10 22:33:05,811 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Processing referral code: ABC123
2025-06-10 22:33:05,811 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 22:33:05,876 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Found referrer with email: john.doe@example.com
2025-06-10 22:33:05,876 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Checking if email already exists: test@example.com
2025-06-10 22:33:05,882 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Generated referral code: IJB1O8
2025-06-10 22:33:05,883 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating new user with email: test@example.com
2025-06-10 22:33:05,976 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Saving user to database
2025-06-10 22:33:05,990 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully saved user with ID: 6
2025-06-10 22:33:05,990 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 22:33:05,996 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 22:33:09,279 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 22:33:09,282 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 22:33:09,282 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 22:33:09,495 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 22:33:09,496 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 22:33:09,496 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 22:33:09,510 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 22:33:09,510 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 22:33:26,180 ERROR o.a.j.l.DirectJDKLog [http-nio-8080-exec-4] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
io.jsonwebtoken.security.SignatureException: JWT signature does not match locally computed signature. JWT validity cannot be asserted and should not be trusted.
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:399)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at com.example.referral.security.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:70)
	at com.example.referral.security.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:62)
	at com.example.referral.security.JwtTokenUtil.getUsernameFromToken(JwtTokenUtil.java:58)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:40)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 22:34:38,393 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 22:34:38,403 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 22:34:38,405 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 22:34:40,796 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 22:34:40,813 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 22005 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 22:34:40,813 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 22:34:40,814 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 22:34:41,347 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 22:34:41,370 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 22:34:41,734 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 22:34:41,738 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 22:34:41,739 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 22:34:41,739 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 22:34:41,759 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 22:34:41,759 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 919 ms
2025-06-10 22:34:41,833 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 22:34:41,915 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 22:34:41,916 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 22:34:41,921 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 22:34:42,011 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 22:34:42,041 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 22:34:42,060 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 22:34:42,154 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 22:34:42,173 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 22:34:42,607 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 22:34:42,629 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 22:34:42,834 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 22:34:43,088 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 22:34:43,354 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 22:34:43,399 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@31eb5ed6, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@e30573c, org.springframework.security.web.context.SecurityContextHolderFilter@5225f612, org.springframework.security.web.header.HeaderWriterFilter@12bb3666, org.springframework.web.filter.CorsFilter@2c70da80, org.springframework.security.web.authentication.logout.LogoutFilter@7d91e9c9, com.example.referral.security.JwtRequestFilter@4203190, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@51a4472d, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2d17b6ad, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@39df2652, org.springframework.security.web.session.SessionManagementFilter@2778f3d1, org.springframework.security.web.access.ExceptionTranslationFilter@5a7e0d68, org.springframework.security.web.access.intercept.AuthorizationFilter@5973d3ec]
2025-06-10 22:34:43,802 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 22:34:43,810 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 22:34:43,819 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.274 seconds (process running for 3.633)
2025-06-10 22:34:44,107 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 22:34:44,107 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 22:34:44,110 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 3 ms
2025-06-10 22:34:47,286 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 22:34:47,293 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Starting signup process for email: test@example.com
2025-06-10 22:34:47,293 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Processing referral code: ABC123
2025-06-10 22:34:47,294 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 22:34:47,363 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Found referrer with email: john.doe@example.com
2025-06-10 22:34:47,363 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Checking if email already exists: test@example.com
2025-06-10 22:34:47,369 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Generated referral code: YNI952
2025-06-10 22:34:47,369 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating new user with email: test@example.com
2025-06-10 22:34:47,462 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Saving user to database
2025-06-10 22:34:47,478 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully saved user with ID: 6
2025-06-10 22:34:47,478 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 22:34:47,483 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 22:34:50,807 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 22:34:50,810 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 22:34:50,810 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 22:34:51,022 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 22:34:51,023 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 22:34:51,024 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 22:34:51,040 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 22:34:51,040 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 22:34:55,120 ERROR o.a.j.l.DirectJDKLog [http-nio-8080-exec-4] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
io.jsonwebtoken.security.SignatureException: JWT signature does not match locally computed signature. JWT validity cannot be asserted and should not be trusted.
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:399)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at com.example.referral.security.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:63)
	at com.example.referral.security.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:55)
	at com.example.referral.security.JwtTokenUtil.getUsernameFromToken(JwtTokenUtil.java:51)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:40)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 22:40:20,837 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 22:40:20,846 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 22:40:20,848 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 22:40:22,968 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 22:40:22,982 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 22106 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 22:40:22,983 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 22:40:22,983 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 22:40:23,462 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 22:40:23,484 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 22:40:23,841 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 22:40:23,846 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 22:40:23,846 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 22:40:23,846 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 22:40:23,867 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 22:40:23,867 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 861 ms
2025-06-10 22:40:23,937 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 22:40:24,011 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 22:40:24,012 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 22:40:24,017 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 22:40:24,108 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 22:40:24,136 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 22:40:24,148 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 22:40:24,240 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 22:40:24,258 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 22:40:24,682 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 22:40:24,705 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 22:40:24,912 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 22:40:25,099 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 22:40:25,342 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 22:40:25,380 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@3e711e84, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@61bbe16d, org.springframework.security.web.context.SecurityContextHolderFilter@41a372c1, org.springframework.security.web.header.HeaderWriterFilter@1d280bab, org.springframework.web.filter.CorsFilter@426fb1c3, org.springframework.security.web.authentication.logout.LogoutFilter@56ed6e17, com.example.referral.security.JwtRequestFilter@13482361, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@347c7b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@aad1270, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5fc3bf09, org.springframework.security.web.session.SessionManagementFilter@62a193e0, org.springframework.security.web.access.ExceptionTranslationFilter@31efe094, org.springframework.security.web.access.intercept.AuthorizationFilter@1d9db780]
2025-06-10 22:40:25,704 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 22:40:25,711 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 22:40:25,720 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 2.974 seconds (process running for 3.271)
2025-06-10 22:40:26,294 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 22:40:26,294 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 22:40:26,296 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 2 ms
2025-06-10 22:40:32,946 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 22:40:32,952 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Starting signup process for email: test@example.com
2025-06-10 22:40:32,952 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Processing referral code: ABC123
2025-06-10 22:40:32,952 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 22:40:33,024 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Found referrer with email: john.doe@example.com
2025-06-10 22:40:33,025 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Checking if email already exists: test@example.com
2025-06-10 22:40:33,031 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Generated referral code: CC5ET0
2025-06-10 22:40:33,031 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating new user with email: test@example.com
2025-06-10 22:40:33,128 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Saving user to database
2025-06-10 22:40:33,142 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully saved user with ID: 6
2025-06-10 22:40:33,142 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 22:40:33,148 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 22:40:36,777 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 22:40:36,780 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 22:40:36,780 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 22:40:37,042 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 22:40:37,043 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 22:40:37,043 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 22:40:37,058 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 22:40:37,059 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 22:40:41,209 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Jwt TOken = eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ0ZXN0QGV4YW1wbGUuY29tIiwiaWF0IjoxNzQ5NTY5MzkxLCJleHAiOjE3NDk2NTU3OTF9.1bFcO0yw2IfUhaAhCu8WjRC_3aWW7zFVlNoUfEEZ-jBaqJ6yJEPrVfebmJWzfLMypU74YDgLfKkYk7CWlhTl9g
2025-06-10 22:40:41,217 ERROR o.a.j.l.DirectJDKLog [http-nio-8080-exec-4] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
io.jsonwebtoken.security.SignatureException: JWT signature does not match locally computed signature. JWT validity cannot be asserted and should not be trusted.
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:399)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at com.example.referral.security.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:63)
	at com.example.referral.security.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:55)
	at com.example.referral.security.JwtTokenUtil.getUsernameFromToken(JwtTokenUtil.java:51)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:43)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 22:41:17,910 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-5] Jwt TOken = eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ0ZXN0QGV4YW1wbGUuY29tIiwiaWF0IjoxNzQ5NTc1NDM3LCJleHAiOjE3NDk2NjE4Mzd9.GiGkczIu3KxxmRCXvcAZKY3hbyI-Vju6hr8yF0OYg8ANMS9_CWqT8O1xozKfshPeBqiApbdEjcwohPDKGgOSug
2025-06-10 22:41:17,972 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-5] Validating token for user: test@example.com
2025-06-10 22:41:48,684 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 22:41:48,692 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 22:41:48,694 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 22:41:50,059 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 22:41:50,072 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 22147 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 22:41:50,073 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 22:41:50,073 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 22:41:50,558 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 22:41:50,580 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 22:41:50,935 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 22:41:50,939 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 22:41:50,939 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 22:41:50,939 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 22:41:50,959 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 22:41:50,959 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 863 ms
2025-06-10 22:41:51,028 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 22:41:51,102 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 22:41:51,102 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 22:41:51,108 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 22:41:51,197 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 22:41:51,222 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 22:41:51,237 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 22:41:51,327 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 22:41:51,347 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 22:41:51,763 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 22:41:51,785 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 22:41:51,982 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 22:41:52,169 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 22:41:52,416 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 22:41:52,459 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@2c70da80, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@39df2652, org.springframework.security.web.context.SecurityContextHolderFilter@5225f612, org.springframework.security.web.header.HeaderWriterFilter@12bb3666, org.springframework.web.filter.CorsFilter@52a9c251, org.springframework.security.web.authentication.logout.LogoutFilter@7d91e9c9, com.example.referral.security.JwtRequestFilter@4203190, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@51a4472d, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2d17b6ad, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5eace68f, org.springframework.security.web.session.SessionManagementFilter@2778f3d1, org.springframework.security.web.access.ExceptionTranslationFilter@5a7e0d68, org.springframework.security.web.access.intercept.AuthorizationFilter@1dd1093c]
2025-06-10 22:41:52,780 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 22:41:52,787 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 22:41:52,796 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 2.965 seconds (process running for 3.269)
2025-06-10 22:41:53,355 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 22:41:53,355 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 22:41:53,358 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 3 ms
2025-06-10 22:42:00,244 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 22:42:00,250 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Starting signup process for email: test@example.com
2025-06-10 22:42:00,250 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Processing referral code: ABC123
2025-06-10 22:42:00,250 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 22:42:00,334 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Found referrer with email: john.doe@example.com
2025-06-10 22:42:00,334 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Checking if email already exists: test@example.com
2025-06-10 22:42:00,339 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Generated referral code: UO1BIW
2025-06-10 22:42:00,339 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating new user with email: test@example.com
2025-06-10 22:42:00,431 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Saving user to database
2025-06-10 22:42:00,445 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully saved user with ID: 6
2025-06-10 22:42:00,446 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 22:42:00,452 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 22:42:03,127 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 22:42:03,130 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 22:42:03,130 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 22:42:03,385 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 22:42:03,386 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 22:42:03,386 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 22:42:03,407 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 22:42:03,407 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 22:42:17,514 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Jwt TOken = eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ0ZXN0QGV4YW1wbGUuY29tIiwiaWF0IjoxNzQ5NTc1NTIzLCJleHAiOjE3NDk2NjE5MjN9.X6HZgcs3JVqKHcnibTgKh0pNAh2m-4seTZm7dLKfhmGdC8ma85MTdcB-DXrVnh75Qj1CX7o_adsP6L5ZE8J2Lg
2025-06-10 22:42:17,581 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-4] Validating token for user: test@example.com
2025-06-10 22:47:07,285 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 22:47:07,294 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 22:47:07,296 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 22:47:09,530 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 22:47:09,548 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 22268 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 22:47:09,548 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 22:47:09,549 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 22:47:10,082 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 22:47:10,105 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 22:47:10,475 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 22:47:10,479 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 22:47:10,480 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 22:47:10,480 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 22:47:10,499 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 22:47:10,499 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 926 ms
2025-06-10 22:47:10,570 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 22:47:10,647 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 22:47:10,648 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 22:47:10,657 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 22:47:10,746 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 22:47:10,776 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 22:47:10,791 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 22:47:10,891 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 22:47:10,911 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 22:47:11,327 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 22:47:11,349 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 22:47:11,550 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 22:47:11,737 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 22:47:11,992 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 22:47:12,030 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5973d3ec, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7b59f3aa, org.springframework.security.web.context.SecurityContextHolderFilter@30a34f07, org.springframework.security.web.header.HeaderWriterFilter@3597174b, org.springframework.web.filter.CorsFilter@1dd1093c, org.springframework.security.web.authentication.logout.LogoutFilter@5b115d71, com.example.referral.security.JwtRequestFilter@753cfae3, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5225f612, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@5e16e521, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@57bd0b3c, org.springframework.security.web.session.SessionManagementFilter@1c93f349, org.springframework.security.web.access.ExceptionTranslationFilter@208bde64, org.springframework.security.web.access.intercept.AuthorizationFilter@43c73b5c]
2025-06-10 22:47:12,357 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 22:47:12,365 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 22:47:12,374 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.097 seconds (process running for 3.451)
2025-06-10 22:47:12,710 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 22:47:12,710 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 22:47:12,711 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 22:47:28,638 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 22:47:28,644 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Starting signup process for email: test@example.com
2025-06-10 22:47:28,644 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Processing referral code: ABC123
2025-06-10 22:47:28,644 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 22:47:28,728 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Found referrer with email: john.doe@example.com
2025-06-10 22:47:28,728 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Checking if email already exists: test@example.com
2025-06-10 22:47:28,733 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Generated referral code: 7M7I4N
2025-06-10 22:47:28,734 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating new user with email: test@example.com
2025-06-10 22:47:28,826 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Saving user to database
2025-06-10 22:47:28,839 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully saved user with ID: 6
2025-06-10 22:47:28,839 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 22:47:28,846 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 22:47:32,765 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 22:47:32,770 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 22:47:32,771 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 22:47:32,978 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 22:47:32,979 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 22:47:32,979 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 22:47:32,997 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 22:47:32,997 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 22:47:58,152 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Jwt TOken = eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ0ZXN0QGV4YW1wbGUuY29tIiwiaWF0IjoxNzQ5NTc1ODUyLCJleHAiOjE3NDk2NjIyNTJ9.at7LtLc9QDCSvNlNqVqs0nICp3AYgMvbfduKbB5R5MwtHfFoubbkb_9hMcGXqM5tvxwWaqxcObwiVifchdmbJg
2025-06-10 22:47:58,179 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Userdetail for user = test@example.com
2025-06-10 22:47:58,226 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-4] Validating token for user: test@example.com
2025-06-10 22:49:27,984 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 22:49:27,996 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 22:49:27,997 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 22:49:30,591 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 22:49:30,605 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 22316 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 22:49:30,605 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 22:49:30,606 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 22:49:31,097 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 22:49:31,119 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 22:49:31,473 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 22:49:31,478 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 22:49:31,478 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 22:49:31,478 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 22:49:31,499 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 22:49:31,499 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 870 ms
2025-06-10 22:49:31,570 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 22:49:31,650 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 22:49:31,650 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 22:49:31,656 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 22:49:31,743 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 22:49:31,768 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 22:49:31,782 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 22:49:31,874 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 22:49:31,893 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 22:49:32,309 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 22:49:32,331 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 22:49:32,529 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 22:49:32,717 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 22:49:32,980 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 22:49:33,043 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5973d3ec, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7b59f3aa, org.springframework.security.web.context.SecurityContextHolderFilter@30a34f07, org.springframework.security.web.header.HeaderWriterFilter@3597174b, org.springframework.web.filter.CorsFilter@1dd1093c, org.springframework.security.web.authentication.logout.LogoutFilter@5b115d71, com.example.referral.security.JwtRequestFilter@326320bb, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5225f612, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@5e16e521, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@57bd0b3c, org.springframework.security.web.session.SessionManagementFilter@1c93f349, org.springframework.security.web.access.ExceptionTranslationFilter@208bde64, org.springframework.security.web.access.intercept.AuthorizationFilter@43c73b5c]
2025-06-10 22:49:33,387 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 22:49:33,397 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 22:49:33,407 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.04 seconds (process running for 3.411)
2025-06-10 22:49:33,893 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 22:49:33,893 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 22:49:33,895 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 2 ms
2025-06-10 22:49:37,281 INFO c.e.r.c.UserController [http-nio-8080-exec-3] trying to signup: test@example.com
2025-06-10 22:49:37,286 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Starting signup process for email: test@example.com
2025-06-10 22:49:37,286 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Processing referral code: ABC123
2025-06-10 22:49:37,287 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Finding user by referral code: ABC123
2025-06-10 22:49:37,354 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Found referrer with email: john.doe@example.com
2025-06-10 22:49:37,354 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Checking if email already exists: test@example.com
2025-06-10 22:49:37,360 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated referral code: R9Q31R
2025-06-10 22:49:37,360 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Creating new user with email: test@example.com
2025-06-10 22:49:37,452 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Saving user to database
2025-06-10 22:49:37,472 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully saved user with ID: 6
2025-06-10 22:49:37,472 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 22:49:37,477 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 22:49:40,423 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Attempting to login user: test@example.com
2025-06-10 22:49:40,427 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Found user with email: test@example.com
2025-06-10 22:49:40,428 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Authenticating user with email: test@example.com
2025-06-10 22:49:40,635 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Successfully authenticated user: test@example.com
2025-06-10 22:49:40,636 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-2] Generating token for user: test@example.com
2025-06-10 22:49:40,636 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-2] Creating token for subject: test@example.com
2025-06-10 22:49:40,645 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Generated token for user: test@example.com
2025-06-10 22:49:40,645 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully logged in user: test@example.com
2025-06-10 22:50:03,633 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-4] Validating token for user: test@example.com
2025-06-10 22:50:03,635 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Token Validated for user: test@example.com
2025-06-10 23:17:32,379 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:17:32,431 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 23:17:32,438 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 23:18:23,160 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 23:18:23,175 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 23020 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 23:18:23,175 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 23:18:23,175 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 23:18:23,704 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 23:18:23,728 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 23:18:24,093 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 23:18:24,097 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 23:18:24,098 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 23:18:24,098 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 23:18:24,119 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 23:18:24,120 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 923 ms
2025-06-10 23:18:24,195 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 23:18:24,278 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 23:18:24,279 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 23:18:24,284 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 23:18:24,375 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 23:18:24,405 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 23:18:24,420 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 23:18:24,518 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 23:18:24,539 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 23:18:24,968 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 23:18:24,990 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:18:25,196 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 23:18:25,388 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 23:18:25,641 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 23:18:25,685 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@68a06914, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@2a59a8fe, org.springframework.security.web.context.SecurityContextHolderFilter@347c7b, org.springframework.security.web.header.HeaderWriterFilter@2e50ca51, org.springframework.web.filter.CorsFilter@43baf0b9, org.springframework.security.web.authentication.logout.LogoutFilter@68553e92, com.example.referral.security.JwtRequestFilter@673a702a, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7e64b248, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@47620803, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@653e79fc, org.springframework.security.web.session.SessionManagementFilter@794fbf0d, org.springframework.security.web.access.ExceptionTranslationFilter@466fb9be, org.springframework.security.web.access.intercept.AuthorizationFilter@3e711e84]
2025-06-10 23:18:26,014 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 23:18:26,021 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 23:18:26,030 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.113 seconds (process running for 3.455)
2025-06-10 23:18:26,422 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(1)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 23:18:26,423 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 23:18:26,424 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 23:18:36,557 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 23:18:36,564 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Starting signup process for email: test@example.com
2025-06-10 23:18:36,564 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Processing referral code: ABC123
2025-06-10 23:18:36,564 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 23:18:36,637 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Found referrer with email: john.doe@example.com
2025-06-10 23:18:36,637 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Checking if email already exists: test@example.com
2025-06-10 23:18:36,643 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Generated referral code: GWEJW9
2025-06-10 23:18:36,643 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating new user with email: test@example.com
2025-06-10 23:18:36,737 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Saving user to database
2025-06-10 23:18:36,751 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully saved user with ID: 6
2025-06-10 23:18:36,751 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 23:18:36,757 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 23:18:40,454 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 23:18:40,458 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 23:18:40,458 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 23:18:40,763 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 23:18:40,764 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 23:18:40,764 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 23:18:40,776 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 23:18:40,776 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 23:18:54,009 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-4] Validating token for user: test@example.com
2025-06-10 23:18:54,011 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Token Validated for user: test@example.com
2025-06-10 23:22:37,644 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:22:37,660 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 23:22:37,663 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 23:22:40,945 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 23:22:40,964 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 23184 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 23:22:40,964 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 23:22:40,964 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 23:22:41,494 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 23:22:41,516 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 20 ms. Found 3 JPA repository interfaces.
2025-06-10 23:22:41,880 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 23:22:41,884 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 23:22:41,885 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 23:22:41,885 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 23:22:41,904 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 23:22:41,905 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 919 ms
2025-06-10 23:22:41,978 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 23:22:42,061 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 23:22:42,061 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 23:22:42,067 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 23:22:42,159 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 23:22:42,188 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 23:22:42,208 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 23:22:42,306 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 23:22:42,326 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 23:22:42,746 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 23:22:42,769 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:22:42,976 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 23:22:43,166 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 23:22:43,421 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 23:22:43,459 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@69f01f4b, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@577e2b91, org.springframework.security.web.context.SecurityContextHolderFilter@461e9b31, org.springframework.security.web.header.HeaderWriterFilter@5dd47c88, org.springframework.web.filter.CorsFilter@68a06914, org.springframework.security.web.authentication.logout.LogoutFilter@650ee893, com.example.referral.security.JwtRequestFilter@3e7c66b3, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@623e578b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@1c93f349, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2a59a8fe, org.springframework.security.web.session.SessionManagementFilter@4af32714, org.springframework.security.web.access.ExceptionTranslationFilter@50fbb66a, org.springframework.security.web.access.intercept.AuthorizationFilter@722a2ba2]
2025-06-10 23:22:43,775 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 23:22:43,783 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 23:22:43,792 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.084 seconds (process running for 3.43)
2025-06-10 23:22:44,269 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 23:22:44,270 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 23:22:44,271 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 23:22:55,482 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 23:22:55,488 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Starting signup process for email: test@example.com
2025-06-10 23:22:55,489 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Processing referral code: ABC123
2025-06-10 23:22:55,489 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 23:22:55,560 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Found referrer with email: john.doe@example.com
2025-06-10 23:22:55,560 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Checking if email already exists: test@example.com
2025-06-10 23:22:55,567 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Generated referral code: V3JWMK
2025-06-10 23:22:55,567 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating new user with email: test@example.com
2025-06-10 23:22:55,663 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Saving user to database
2025-06-10 23:22:55,677 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully saved user with ID: 6
2025-06-10 23:22:55,677 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 23:22:55,684 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 23:22:58,800 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 23:22:58,802 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 23:22:58,802 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 23:22:59,010 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 23:22:59,011 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 23:22:59,011 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 23:22:59,020 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 23:22:59,021 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 23:23:26,576 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-4] Validating token for user: test@example.com
2025-06-10 23:23:26,578 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Token Validated for user: test@example.com
2025-06-10 23:29:34,221 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:29:34,230 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 23:29:34,234 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 23:29:37,096 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 23:29:37,115 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 23336 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 23:29:37,115 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 23:29:37,115 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 23:29:37,641 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 23:29:37,664 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 21 ms. Found 3 JPA repository interfaces.
2025-06-10 23:29:38,043 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 23:29:38,047 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 23:29:38,048 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 23:29:38,048 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 23:29:38,067 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 23:29:38,068 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 926 ms
2025-06-10 23:29:38,138 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 23:29:38,233 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 23:29:38,234 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 23:29:38,239 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 23:29:38,357 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 23:29:38,386 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 23:29:38,401 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 23:29:38,500 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 23:29:38,519 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 23:29:38,936 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 23:29:38,958 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:29:39,162 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 23:29:39,351 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 23:29:39,600 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 23:29:39,638 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@68553e92, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@45144fdf, org.springframework.security.web.context.SecurityContextHolderFilter@6f0124b5, org.springframework.security.web.header.HeaderWriterFilter@7e32f76b, org.springframework.web.filter.CorsFilter@57cc7d9e, org.springframework.security.web.authentication.logout.LogoutFilter@40a0364a, com.example.referral.security.JwtRequestFilter@34a48013, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5dd47c88, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2a0c76d6, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@23c07745, org.springframework.security.web.session.SessionManagementFilter@6987a0f3, org.springframework.security.web.access.ExceptionTranslationFilter@29483d10, org.springframework.security.web.access.intercept.AuthorizationFilter@56ed6e17]
2025-06-10 23:29:39,962 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 23:29:39,974 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 23:29:39,983 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.139 seconds (process running for 3.487)
2025-06-10 23:29:40,326 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 23:29:40,326 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 23:29:40,329 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 3 ms
2025-06-10 23:29:52,790 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 23:29:52,796 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Starting signup process for email: test@example.com
2025-06-10 23:29:52,796 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Processing referral code: ABC123
2025-06-10 23:29:52,796 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 23:29:52,873 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Found referrer with email: john.doe@example.com
2025-06-10 23:29:52,873 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Checking if email already exists: test@example.com
2025-06-10 23:29:52,879 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Generated referral code: 1Z7L39
2025-06-10 23:29:52,879 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating new user with email: test@example.com
2025-06-10 23:29:52,972 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Saving user to database
2025-06-10 23:29:52,986 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully saved user with ID: 6
2025-06-10 23:29:52,986 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 23:29:52,992 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 23:29:55,851 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 23:29:55,853 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 23:29:55,853 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 23:29:56,062 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 23:29:56,062 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 23:29:56,062 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 23:29:56,072 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 23:29:56,073 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 23:30:08,809 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-4] Validating token for user: test@example.com
2025-06-10 23:30:08,811 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Token Validated for user: test@example.com
2025-06-10 23:31:17,785 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:31:17,798 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 23:31:17,799 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 23:31:20,082 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 23:31:20,098 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 23382 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 23:31:20,098 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 23:31:20,098 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 23:31:20,580 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 23:31:20,602 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 23:31:20,958 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 23:31:20,962 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 23:31:20,963 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 23:31:20,963 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 23:31:20,983 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 23:31:20,983 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 862 ms
2025-06-10 23:31:21,053 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 23:31:21,126 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 23:31:21,127 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 23:31:21,132 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 23:31:21,222 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 23:31:21,247 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 23:31:21,261 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 23:31:21,357 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 23:31:21,380 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 23:31:21,791 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 23:31:21,813 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:31:22,009 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 23:31:22,196 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 23:31:22,443 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 23:31:22,480 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@40830e1e, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@4f578fc2, org.springframework.security.web.context.SecurityContextHolderFilter@2eb95662, org.springframework.security.web.header.HeaderWriterFilter@29483d10, org.springframework.web.filter.CorsFilter@26350832, org.springframework.security.web.authentication.logout.LogoutFilter@201a84e1, com.example.referral.security.JwtRequestFilter@619944a7, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@50fbb66a, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6f0124b5, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@7d1cdebf, org.springframework.security.web.session.SessionManagementFilter@5066a895, org.springframework.security.web.access.ExceptionTranslationFilter@2531049f, org.springframework.security.web.access.intercept.AuthorizationFilter@204d101]
2025-06-10 23:31:22,806 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 23:31:22,813 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 23:31:22,822 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 2.974 seconds (process running for 3.263)
2025-06-10 23:31:23,396 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 23:31:23,396 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 23:31:23,397 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 23:31:32,010 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 23:31:32,015 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Starting signup process for email: test@example.com
2025-06-10 23:31:32,015 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Processing referral code: ABC123
2025-06-10 23:31:32,015 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 23:31:32,079 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Found referrer with email: john.doe@example.com
2025-06-10 23:31:32,079 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Checking if email already exists: test@example.com
2025-06-10 23:31:32,085 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Generated referral code: 7198LR
2025-06-10 23:31:32,086 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating new user with email: test@example.com
2025-06-10 23:31:32,178 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Saving user to database
2025-06-10 23:31:32,197 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully saved user with ID: 6
2025-06-10 23:31:32,197 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 23:31:32,204 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 23:31:35,322 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 23:31:35,325 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 23:31:35,326 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 23:31:35,538 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 23:31:35,538 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 23:31:35,538 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 23:31:35,547 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 23:31:35,547 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 23:31:50,677 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-4] Validating token for user: test@example.com
2025-06-10 23:31:50,679 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Token Validated for user: test@example.com
2025-06-10 23:31:50,682 INFO c.e.r.c.ProfileController [http-nio-8080-exec-4] Getting profile for user: test@example.com
2025-06-10 23:32:15,793 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-5] Validating token for user: test@example.com
2025-06-10 23:32:15,797 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-5] Token Validated for user: test@example.com
2025-06-10 23:32:15,803 INFO c.e.r.c.ProfileController [http-nio-8080-exec-5] Updating profile for user: test@example.com
2025-06-10 23:32:15,817 ERROR c.e.r.c.ProfileController [http-nio-8080-exec-5] Error updating profile for user: test@example.com - Unauthorized to complete this referral
java.lang.RuntimeException: Unauthorized to complete this referral
	at com.example.referral.service.ReferralService.completeReferral(ReferralService.java:67)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:385)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.example.referral.service.ReferralService$$SpringCGLIB$$0.completeReferral(<generated>)
	at com.example.referral.service.ProfileService.lambda$checkAndCompleteReferrals$1(ProfileService.java:57)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:197)
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1709)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:570)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at com.example.referral.service.ProfileService.checkAndCompleteReferrals(ProfileService.java:57)
	at com.example.referral.service.ProfileService.createOrUpdateProfile(ProfileService.java:40)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:385)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.example.referral.service.ProfileService$$SpringCGLIB$$0.createOrUpdateProfile(<generated>)
	at com.example.referral.controller.ProfileController.updateProfile(ProfileController.java:52)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:259)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:192)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:920)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:830)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:888)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:72)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 23:32:24,384 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-7] Validating token for user: test@example.com
2025-06-10 23:32:24,386 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-7] Token Validated for user: test@example.com
2025-06-10 23:32:24,393 INFO c.e.r.c.ProfileController [http-nio-8080-exec-7] Updating profile for user: test@example.com
2025-06-10 23:32:24,401 ERROR c.e.r.c.ProfileController [http-nio-8080-exec-7] Error updating profile for user: test@example.com - Unauthorized to complete this referral
java.lang.RuntimeException: Unauthorized to complete this referral
	at com.example.referral.service.ReferralService.completeReferral(ReferralService.java:67)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:385)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.example.referral.service.ReferralService$$SpringCGLIB$$0.completeReferral(<generated>)
	at com.example.referral.service.ProfileService.lambda$checkAndCompleteReferrals$1(ProfileService.java:57)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:197)
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1709)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:570)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at com.example.referral.service.ProfileService.checkAndCompleteReferrals(ProfileService.java:57)
	at com.example.referral.service.ProfileService.createOrUpdateProfile(ProfileService.java:40)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:385)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.example.referral.service.ProfileService$$SpringCGLIB$$0.createOrUpdateProfile(<generated>)
	at com.example.referral.controller.ProfileController.updateProfile(ProfileController.java:52)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:259)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:192)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:920)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:830)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:888)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:72)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 23:35:39,049 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:35:39,062 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 23:35:39,064 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 23:35:41,528 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 23:35:41,547 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 23494 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 23:35:41,548 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 23:35:41,548 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 23:35:42,084 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 23:35:42,107 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 23:35:42,473 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 23:35:42,478 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 23:35:42,478 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 23:35:42,479 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 23:35:42,499 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 23:35:42,499 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 915 ms
2025-06-10 23:35:42,570 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 23:35:42,653 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 23:35:42,653 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 23:35:42,659 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 23:35:42,751 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 23:35:42,782 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 23:35:42,796 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 23:35:42,897 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 23:35:42,917 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 23:35:43,416 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 23:35:43,440 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:35:43,683 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 23:35:43,869 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 23:35:44,119 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 23:35:44,168 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@72e36d0f, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5031786b, org.springframework.security.web.context.SecurityContextHolderFilter@54950027, org.springframework.security.web.header.HeaderWriterFilter@4f8e6101, org.springframework.web.filter.CorsFilter@40830e1e, org.springframework.security.web.authentication.logout.LogoutFilter@347c7b, com.example.referral.security.JwtRequestFilter@672ba9cc, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@6987a0f3, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@282c3aa0, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@4f578fc2, org.springframework.security.web.session.SessionManagementFilter@3c41b4b, org.springframework.security.web.access.ExceptionTranslationFilter@d3effcb, org.springframework.security.web.access.intercept.AuthorizationFilter@5930a229]
2025-06-10 23:35:44,498 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 23:35:44,505 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 23:35:44,514 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.237 seconds (process running for 3.596)
2025-06-10 23:35:44,769 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 23:35:44,769 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 23:35:44,771 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 23:35:50,356 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 23:35:50,370 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Starting signup process for email: test@example.com
2025-06-10 23:35:50,370 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Processing referral code: ABC123
2025-06-10 23:35:50,370 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 23:35:50,439 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Found referrer with email: john.doe@example.com
2025-06-10 23:35:50,440 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Checking if email already exists: test@example.com
2025-06-10 23:35:50,447 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Generated referral code: CNWOIW
2025-06-10 23:35:50,447 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating new user with email: test@example.com
2025-06-10 23:35:50,542 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Saving user to database
2025-06-10 23:35:50,555 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully saved user with ID: 6
2025-06-10 23:35:50,556 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 23:35:50,562 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 23:35:53,168 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 23:35:53,171 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 23:35:53,171 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 23:35:53,381 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 23:35:53,382 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 23:35:53,382 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 23:35:53,397 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 23:35:53,398 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 23:36:13,899 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-4] Validating token for user: test@example.com
2025-06-10 23:36:13,902 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Token Validated for user: test@example.com
2025-06-10 23:36:13,905 INFO c.e.r.c.ProfileController [http-nio-8080-exec-4] Getting profile for user: test@example.com
2025-06-10 23:36:25,032 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-5] Validating token for user: test@example.com
2025-06-10 23:36:25,033 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-5] Token Validated for user: test@example.com
2025-06-10 23:36:25,039 INFO c.e.r.c.ProfileController [http-nio-8080-exec-5] Updating profile for user: test@example.com
2025-06-10 23:36:25,059 WARN c.e.r.s.ProfileService [http-nio-8080-exec-5] Failed to complete referral 1 for user test@example.com: Unauthorized to complete this referral
2025-06-10 23:36:25,061 ERROR c.e.r.c.ProfileController [http-nio-8080-exec-5] Error updating profile for user: test@example.com - Transaction silently rolled back because it has been marked as rollback-only
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:803)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:669)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:419)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.example.referral.service.ProfileService$$SpringCGLIB$$0.createOrUpdateProfile(<generated>)
	at com.example.referral.controller.ProfileController.updateProfile(ProfileController.java:52)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:259)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:192)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:920)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:830)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:888)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:72)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 23:38:43,914 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:38:43,927 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 23:38:43,930 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 23:38:46,708 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 23:38:46,727 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 23637 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 23:38:46,727 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 23:38:46,728 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 23:38:47,487 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 23:38:47,533 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 40 ms. Found 3 JPA repository interfaces.
2025-06-10 23:38:47,929 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 23:38:47,933 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 23:38:47,934 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 23:38:47,934 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 23:38:47,956 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 23:38:47,956 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1203 ms
2025-06-10 23:38:48,028 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 23:38:48,113 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 23:38:48,114 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 23:38:48,119 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 23:38:48,216 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 23:38:48,247 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 23:38:48,262 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 23:38:48,363 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 23:38:48,382 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 23:38:48,820 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 23:38:48,843 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:38:49,064 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 23:38:49,255 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 23:38:49,532 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 23:38:49,574 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@58179860, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@43e55cfb, org.springframework.security.web.context.SecurityContextHolderFilter@50fbb66a, org.springframework.security.web.header.HeaderWriterFilter@559d9517, org.springframework.web.filter.CorsFilter@582ea857, org.springframework.security.web.authentication.logout.LogoutFilter@7e4f5062, com.example.referral.security.JwtRequestFilter@7bd6c35e, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5498d2a2, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@5dd47c88, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@650ee893, org.springframework.security.web.session.SessionManagementFilter@11b5b1f2, org.springframework.security.web.access.ExceptionTranslationFilter@63a6dffd, org.springframework.security.web.access.intercept.AuthorizationFilter@40830e1e]
2025-06-10 23:38:49,893 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 23:38:49,901 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 23:38:49,910 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.463 seconds (process running for 3.932)
2025-06-10 23:38:50,581 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(1)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 23:38:50,581 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 23:38:50,586 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(1)-127.0.0.1] Completed initialization in 3 ms
2025-06-10 23:38:55,558 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:38:55,562 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 23:38:55,564 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 23:38:58,101 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 23:38:58,114 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 23645 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 23:38:58,115 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 23:38:58,115 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 23:38:58,603 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 23:38:58,624 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 18 ms. Found 3 JPA repository interfaces.
2025-06-10 23:38:58,978 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 23:38:58,982 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 23:38:58,983 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 23:38:58,983 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 23:38:59,003 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 23:38:59,003 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 865 ms
2025-06-10 23:38:59,074 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 23:38:59,146 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 23:38:59,147 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 23:38:59,156 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 23:38:59,239 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 23:38:59,265 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 23:38:59,280 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 23:38:59,373 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 23:38:59,391 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 23:38:59,811 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 23:38:59,834 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:39:00,031 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 23:39:00,218 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 23:39:00,471 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 23:39:00,508 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@4f578fc2, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@26350832, org.springframework.security.web.context.SecurityContextHolderFilter@4d87553b, org.springframework.security.web.header.HeaderWriterFilter@601c953c, org.springframework.web.filter.CorsFilter@7d1cdebf, org.springframework.security.web.authentication.logout.LogoutFilter@414a3c7d, com.example.referral.security.JwtRequestFilter@34a48013, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@12bb0322, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@5498d2a2, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@25b7ccfc, org.springframework.security.web.session.SessionManagementFilter@6eec564c, org.springframework.security.web.access.ExceptionTranslationFilter@14404be2, org.springframework.security.web.access.intercept.AuthorizationFilter@716a6343]
2025-06-10 23:39:00,829 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 23:39:00,837 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 23:39:00,849 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 2.964 seconds (process running for 3.267)
2025-06-10 23:39:01,444 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 23:39:01,445 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 23:39:01,446 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 23:39:15,652 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 23:39:15,658 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Starting signup process for email: test@example.com
2025-06-10 23:39:15,658 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Processing referral code: ABC123
2025-06-10 23:39:15,658 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 23:39:15,732 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Found referrer with email: john.doe@example.com
2025-06-10 23:39:15,732 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Checking if email already exists: test@example.com
2025-06-10 23:39:15,738 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Generated referral code: RBD250
2025-06-10 23:39:15,738 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating new user with email: test@example.com
2025-06-10 23:39:15,841 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Saving user to database
2025-06-10 23:39:15,867 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully saved user with ID: 6
2025-06-10 23:39:15,868 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 23:39:15,876 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 23:39:23,294 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 23:39:23,297 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 23:39:23,297 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 23:39:23,509 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 23:39:23,509 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 23:39:23,509 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 23:39:23,520 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 23:39:23,520 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 23:39:36,346 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-4] Validating token for user: test@example.com
2025-06-10 23:39:36,348 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Token Validated for user: test@example.com
2025-06-10 23:39:36,353 INFO c.e.r.c.ProfileController [http-nio-8080-exec-4] Updating profile for user: test@example.com
2025-06-10 23:39:36,372 WARN c.e.r.s.ProfileService [http-nio-8080-exec-4] Failed to complete referral 1 for user test@example.com: Unauthorized to complete this referral
2025-06-10 23:39:36,372 ERROR c.e.r.c.ProfileController [http-nio-8080-exec-4] Error updating profile for user: test@example.com - Transaction silently rolled back because it has been marked as rollback-only
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:803)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:669)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:419)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.example.referral.service.ProfileService$$SpringCGLIB$$0.createOrUpdateProfile(<generated>)
	at com.example.referral.controller.ProfileController.updateProfile(ProfileController.java:52)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:259)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:192)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:920)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:830)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:888)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:72)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 23:40:51,596 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:40:51,604 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 23:40:51,606 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 23:40:53,903 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 23:40:53,921 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 23695 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 23:40:53,921 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 23:40:53,921 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 23:40:54,442 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 23:40:54,464 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 18 ms. Found 3 JPA repository interfaces.
2025-06-10 23:40:54,835 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 23:40:54,841 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 23:40:54,844 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 23:40:54,844 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 23:40:54,864 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 23:40:54,864 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 918 ms
2025-06-10 23:40:54,935 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 23:40:55,014 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 23:40:55,015 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 23:40:55,024 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 23:40:55,120 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 23:40:55,150 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 23:40:55,164 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 23:40:55,265 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 23:40:55,286 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 23:40:55,701 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 23:40:55,725 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:40:55,926 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 23:40:56,116 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 23:40:56,361 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 23:40:56,406 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@704205ef, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@18ee9a8f, org.springframework.security.web.context.SecurityContextHolderFilter@5dd47c88, org.springframework.security.web.header.HeaderWriterFilter@356c8c1b, org.springframework.web.filter.CorsFilter@61aaec51, org.springframework.security.web.authentication.logout.LogoutFilter@5503e208, com.example.referral.security.JwtRequestFilter@7bd6c35e, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@c4f6d5b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@5a7e0d68, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@69dc0dd1, org.springframework.security.web.session.SessionManagementFilter@50fbb66a, org.springframework.security.web.access.ExceptionTranslationFilter@5ca67657, org.springframework.security.web.access.intercept.AuthorizationFilter@57cc7d9e]
2025-06-10 23:40:56,737 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 23:40:56,745 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 23:40:56,754 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.111 seconds (process running for 3.44)
2025-06-10 23:40:57,171 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 23:40:57,171 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 23:40:57,174 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 2 ms
2025-06-10 23:41:05,721 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 23:41:05,730 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Starting signup process for email: test@example.com
2025-06-10 23:41:05,730 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Processing referral code: ABC123
2025-06-10 23:41:05,730 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 23:41:05,817 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Found referrer with email: john.doe@example.com
2025-06-10 23:41:05,817 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Checking if email already exists: test@example.com
2025-06-10 23:41:05,823 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Generated referral code: V6D3FM
2025-06-10 23:41:05,823 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating new user with email: test@example.com
2025-06-10 23:41:05,916 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Saving user to database
2025-06-10 23:41:05,930 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully saved user with ID: 6
2025-06-10 23:41:05,930 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 23:41:05,937 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 23:41:10,609 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 23:41:10,612 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 23:41:10,612 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 23:41:10,821 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 23:41:10,821 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 23:41:10,821 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 23:41:10,836 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 23:41:10,836 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 23:41:25,719 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-4] Validating token for user: test@example.com
2025-06-10 23:41:25,721 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Token Validated for user: test@example.com
2025-06-10 23:41:25,725 INFO c.e.r.c.ProfileController [http-nio-8080-exec-4] Getting profile for user: test@example.com
2025-06-10 23:41:29,710 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-5] Validating token for user: test@example.com
2025-06-10 23:41:29,713 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-5] Token Validated for user: test@example.com
2025-06-10 23:41:29,719 INFO c.e.r.c.ProfileController [http-nio-8080-exec-5] Updating profile for user: test@example.com
2025-06-10 23:41:29,740 WARN c.e.r.s.ProfileService [ForkJoinPool.commonPool-worker-1] Failed to complete referral 1 for user test@example.com: Unauthorized to complete this referral
2025-06-10 23:41:39,811 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-6] Validating token for user: test@example.com
2025-06-10 23:41:39,813 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-6] Token Validated for user: test@example.com
2025-06-10 23:42:29,603 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-10] Validating token for user: test@example.com
2025-06-10 23:42:29,606 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-10] Token Validated for user: test@example.com
2025-06-10 23:42:29,608 INFO c.e.r.c.ProfileController [http-nio-8080-exec-10] Getting profile for user: test@example.com
2025-06-10 23:42:50,052 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-2] Validating token for user: test@example.com
2025-06-10 23:42:50,053 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-2] Token Validated for user: test@example.com
2025-06-10 23:44:07,612 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:44:07,622 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 23:44:07,624 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 23:44:09,899 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 23:44:09,915 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 23768 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 23:44:09,915 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 23:44:09,916 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 23:44:10,435 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 23:44:10,457 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 23:44:10,820 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 23:44:10,824 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 23:44:10,825 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 23:44:10,825 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 23:44:10,845 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 23:44:10,845 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 904 ms
2025-06-10 23:44:10,918 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 23:44:10,996 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 23:44:10,996 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 23:44:11,001 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 23:44:11,100 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 23:44:11,135 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 23:44:11,154 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 23:44:11,273 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 23:44:11,295 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 23:44:11,752 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 23:44:11,775 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:44:11,989 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 23:44:12,187 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 23:44:12,472 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 23:44:12,510 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@71702d3f, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6f9d1785, org.springframework.security.web.context.SecurityContextHolderFilter@7f69a16b, org.springframework.security.web.header.HeaderWriterFilter@db9ecd, org.springframework.web.filter.CorsFilter@f9b97dc, org.springframework.security.web.authentication.logout.LogoutFilter@8b329ae, com.example.referral.security.JwtRequestFilter@2ee949d4, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@356c8c1b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3c41b4b, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@25ea3a5f, org.springframework.security.web.session.SessionManagementFilter@29483d10, org.springframework.security.web.access.ExceptionTranslationFilter@397f3ff5, org.springframework.security.web.access.intercept.AuthorizationFilter@47620803]
2025-06-10 23:44:12,827 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 23:44:12,838 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 23:44:12,847 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.2 seconds (process running for 3.522)
2025-06-10 23:44:13,142 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 23:44:13,143 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 23:44:13,144 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 1 ms
2025-06-10 23:44:37,524 INFO c.e.r.c.UserController [http-nio-8080-exec-2] trying to signup: test@example.com
2025-06-10 23:44:37,530 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Starting signup process for email: test@example.com
2025-06-10 23:44:37,530 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Processing referral code: ABC123
2025-06-10 23:44:37,530 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Finding user by referral code: ABC123
2025-06-10 23:44:37,604 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Found referrer with email: john.doe@example.com
2025-06-10 23:44:37,605 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Checking if email already exists: test@example.com
2025-06-10 23:44:37,610 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Generated referral code: IRS44C
2025-06-10 23:44:37,611 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating new user with email: test@example.com
2025-06-10 23:44:37,717 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Saving user to database
2025-06-10 23:44:37,732 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully saved user with ID: 6
2025-06-10 23:44:37,733 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 23:44:37,742 INFO c.e.r.s.UserService [http-nio-8080-exec-2] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 23:44:41,348 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 23:44:41,350 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 23:44:41,350 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 23:44:41,555 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 23:44:41,556 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 23:44:41,556 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 23:44:41,566 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Generated token for user: test@example.com
2025-06-10 23:44:41,566 INFO c.e.r.s.UserService [http-nio-8080-exec-3] Successfully logged in user: test@example.com
2025-06-10 23:44:59,406 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-4] Validating token for user: test@example.com
2025-06-10 23:44:59,409 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-4] Token Validated for user: test@example.com
2025-06-10 23:44:59,411 INFO c.e.r.c.ProfileController [http-nio-8080-exec-4] Getting profile for user: test@example.com
2025-06-10 23:45:15,488 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-5] Validating token for user: test@example.com
2025-06-10 23:45:15,490 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-5] Token Validated for user: test@example.com
2025-06-10 23:45:15,499 INFO c.e.r.c.ProfileController [http-nio-8080-exec-5] Updating profile for user: test@example.com
2025-06-10 23:45:19,410 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-6] Validating token for user: test@example.com
2025-06-10 23:45:19,413 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-6] Token Validated for user: test@example.com
2025-06-10 23:45:19,414 INFO c.e.r.c.ProfileController [http-nio-8080-exec-6] Getting profile for user: test@example.com
2025-06-10 23:46:15,512 ERROR c.e.r.s.JwtRequestFilter [http-nio-8080-exec-7] Error extracting username from token: JWT signature does not match locally computed signature. JWT validity cannot be asserted and should not be trusted.
2025-06-10 23:46:24,960 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-8] Validating token for user: test@example.com
2025-06-10 23:46:24,964 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-8] Token Validated for user: test@example.com
2025-06-10 23:48:58,230 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:48:58,242 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 23:48:58,244 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 23:49:00,506 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 23:49:00,523 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 23909 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 23:49:00,523 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 23:49:00,523 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 23:49:01,253 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 23:49:01,289 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 29 ms. Found 3 JPA repository interfaces.
2025-06-10 23:49:01,659 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 23:49:01,663 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 23:49:01,664 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 23:49:01,664 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 23:49:01,684 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 23:49:01,684 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1135 ms
2025-06-10 23:49:01,757 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 23:49:01,845 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 23:49:01,846 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 23:49:01,851 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 23:49:01,947 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 23:49:01,977 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 23:49:01,992 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 23:49:02,098 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 23:49:02,118 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 23:49:02,535 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 23:49:02,557 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:49:02,748 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 23:49:02,946 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 23:49:03,192 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 23:49:03,239 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@461e9b31, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@d5d9d92, org.springframework.security.web.context.SecurityContextHolderFilter@1743c249, org.springframework.security.web.header.HeaderWriterFilter@1db4ea47, org.springframework.web.filter.CorsFilter@347c7b, org.springframework.security.web.authentication.logout.LogoutFilter@282c3aa0, com.example.referral.security.JwtRequestFilter@63cff421, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5c934077, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@1a02063a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@126f428e, org.springframework.security.web.session.SessionManagementFilter@23ac164d, org.springframework.security.web.access.ExceptionTranslationFilter@4b87ea3c, org.springframework.security.web.access.intercept.AuthorizationFilter@74efc394]
2025-06-10 23:49:03,559 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 23:49:03,567 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 23:49:03,576 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.318 seconds (process running for 3.651)
2025-06-10 23:49:03,762 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(3)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 23:49:03,762 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 23:49:03,764 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(3)-127.0.0.1] Completed initialization in 2 ms
2025-06-10 23:49:11,328 INFO c.e.r.c.UserController [http-nio-8080-exec-1] trying to signup: test@example.com
2025-06-10 23:49:11,338 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Starting signup process for email: test@example.com
2025-06-10 23:49:11,338 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Processing referral code: ABC123
2025-06-10 23:49:11,338 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Finding user by referral code: ABC123
2025-06-10 23:49:11,409 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Found referrer with email: john.doe@example.com
2025-06-10 23:49:11,410 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Checking if email already exists: test@example.com
2025-06-10 23:49:11,415 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Generated referral code: EY6TQ1
2025-06-10 23:49:11,415 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating new user with email: test@example.com
2025-06-10 23:49:11,508 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Saving user to database
2025-06-10 23:49:11,523 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully saved user with ID: 6
2025-06-10 23:49:11,523 DEBUG c.e.r.s.UserService [http-nio-8080-exec-1] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 23:49:11,529 INFO c.e.r.s.UserService [http-nio-8080-exec-1] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 23:49:14,970 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Attempting to login user: test@example.com
2025-06-10 23:49:14,972 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Found user with email: test@example.com
2025-06-10 23:49:14,972 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Authenticating user with email: test@example.com
2025-06-10 23:49:15,182 DEBUG c.e.r.s.UserService [http-nio-8080-exec-3] Successfully authenticated user: test@example.com
2025-06-10 23:49:15,182 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Generating token for user: test@example.com
2025-06-10 23:49:15,182 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-3] Creating token for subject: test@example.com
2025-06-10 23:49:15,189 ERROR c.e.r.s.UserService [http-nio-8080-exec-3] Unexpected error during login for user: test@example.com - The signing key's size is 504 bits which is not secure enough for the HS512 algorithm.  The JWT JWA Specification (RFC 7518, Section 3.2) states that keys used with HS512 MUST have a size >= 512 bits (the key size must be greater than or equal to the hash output size).  Consider using the io.jsonwebtoken.security.Keys class's 'secretKeyFor(SignatureAlgorithm.HS512)' method to create a key guaranteed to be secure enough for HS512.  See https://tools.ietf.org/html/rfc7518#section-3.2 for more information.
io.jsonwebtoken.security.WeakKeyException: The signing key's size is 504 bits which is not secure enough for the HS512 algorithm.  The JWT JWA Specification (RFC 7518, Section 3.2) states that keys used with HS512 MUST have a size >= 512 bits (the key size must be greater than or equal to the hash output size).  Consider using the io.jsonwebtoken.security.Keys class's 'secretKeyFor(SignatureAlgorithm.HS512)' method to create a key guaranteed to be secure enough for HS512.  See https://tools.ietf.org/html/rfc7518#section-3.2 for more information.
	at io.jsonwebtoken.SignatureAlgorithm.assertValid(SignatureAlgorithm.java:387)
	at io.jsonwebtoken.SignatureAlgorithm.assertValidSigningKey(SignatureAlgorithm.java:315)
	at io.jsonwebtoken.impl.DefaultJwtBuilder.signWith(DefaultJwtBuilder.java:112)
	at com.example.referral.security.JwtTokenUtil.createToken(JwtTokenUtil.java:44)
	at com.example.referral.security.JwtTokenUtil.generateToken(JwtTokenUtil.java:34)
	at com.example.referral.service.UserService.login(UserService.java:133)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at io.micrometer.core.aop.TimedAspect.processWithTimer(TimedAspect.java:227)
	at io.micrometer.core.aop.TimedAspect.perform(TimedAspect.java:202)
	at io.micrometer.core.aop.TimedAspect.timedMethod(TimedAspect.java:194)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:637)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:627)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:71)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.example.referral.service.UserService$$SpringCGLIB$$0.login(<generated>)
	at com.example.referral.controller.UserController.login(UserController.java:55)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:259)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:192)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:920)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:830)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at com.example.referral.security.JwtRequestFilter.doFilterInternal(JwtRequestFilter.java:72)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
2025-06-10 23:49:15,191 ERROR c.e.r.c.UserController [http-nio-8080-exec-3] Login failed: Error during login: The signing key's size is 504 bits which is not secure enough for the HS512 algorithm.  The JWT JWA Specification (RFC 7518, Section 3.2) states that keys used with HS512 MUST have a size >= 512 bits (the key size must be greater than or equal to the hash output size).  Consider using the io.jsonwebtoken.security.Keys class's 'secretKeyFor(SignatureAlgorithm.HS512)' method to create a key guaranteed to be secure enough for HS512.  See https://tools.ietf.org/html/rfc7518#section-3.2 for more information.
2025-06-10 23:51:46,539 INFO o.s.o.j.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:51:46,550 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2025-06-10 23:51:46,552 INFO c.z.h.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2025-06-10 23:51:48,990 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.1.Final
2025-06-10 23:51:49,009 INFO o.s.b.StartupInfoLogger [main] Starting UserReferralApplication using Java 23.0.1 with PID 24050 (/Users/arpit/Developer/SpringBoot/UserReferral/target/classes started by arpit in /Users/arpit/Developer/SpringBoot/UserReferral)
2025-06-10 23:51:49,009 DEBUG o.s.b.StartupInfoLogger [main] Running with Spring Boot v3.2.3, Spring v6.1.4
2025-06-10 23:51:49,009 INFO o.s.b.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2025-06-10 23:51:49,542 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-10 23:51:49,565 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-06-10 23:51:49,940 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat initialized with port 8080 (http)
2025-06-10 23:51:49,944 INFO o.a.j.l.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8080"]
2025-06-10 23:51:49,945 INFO o.a.j.l.DirectJDKLog [main] Starting service [Tomcat]
2025-06-10 23:51:49,945 INFO o.a.j.l.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-06-10 23:51:49,966 INFO o.a.j.l.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2025-06-10 23:51:49,966 INFO o.s.b.w.s.c.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 932 ms
2025-06-10 23:51:50,040 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Starting...
2025-06-10 23:51:50,126 INFO c.z.h.p.HikariPool [main] HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:referraldb user=SA
2025-06-10 23:51:50,127 INFO c.z.h.HikariDataSource [main] HikariPool-1 - Start completed.
2025-06-10 23:51:50,132 INFO o.s.b.a.h.H2ConsoleAutoConfiguration [main] H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:referraldb'
2025-06-10 23:51:50,227 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-10 23:51:50,257 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.4.4.Final
2025-06-10 23:51:50,271 INFO o.h.c.i.RegionFactoryInitiator [main] HHH000026: Second-level cache disabled
2025-06-10 23:51:50,373 INFO o.s.o.j.p.SpringPersistenceUnitInfo [main] No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-10 23:51:50,394 WARN o.h.e.j.d.i.DialectFactoryImpl [main] HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-10 23:51:50,815 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-10 23:51:50,839 INFO o.s.o.j.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-10 23:51:51,048 DEBUG o.s.w.f.GenericFilterBean [main] Filter 'jwtRequestFilter' configured for use
2025-06-10 23:51:51,237 WARN o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-10 23:51:51,487 INFO o.s.b.a.e.w.EndpointLinksResolver [main] Exposing 4 endpoint(s) beneath base path '/actuator'
2025-06-10 23:51:51,535 INFO o.s.s.w.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5031786b, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@40830e1e, org.springframework.security.web.context.SecurityContextHolderFilter@11b5b1f2, org.springframework.security.web.header.HeaderWriterFilter@1a02063a, org.springframework.web.filter.CorsFilter@4f578fc2, org.springframework.security.web.authentication.logout.LogoutFilter@126f428e, com.example.referral.security.JwtRequestFilter@564e0a6c, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1e5e0e75, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@25699129, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@26350832, org.springframework.security.web.session.SessionManagementFilter@55a4a0ab, org.springframework.security.web.access.ExceptionTranslationFilter@1743c249, org.springframework.security.web.access.intercept.AuthorizationFilter@6bd21eb7]
2025-06-10 23:51:51,855 INFO o.a.j.l.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8080"]
2025-06-10 23:51:51,863 INFO o.s.b.w.e.t.TomcatWebServer [main] Tomcat started on port 8080 (http) with context path ''
2025-06-10 23:51:51,871 INFO o.s.b.StartupInfoLogger [main] Started UserReferralApplication in 3.135 seconds (process running for 3.51)
2025-06-10 23:51:52,234 INFO o.a.j.l.DirectJDKLog [RMI TCP Connection(2)-127.0.0.1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-10 23:51:52,234 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Initializing Servlet 'dispatcherServlet'
2025-06-10 23:51:52,236 INFO o.s.w.s.FrameworkServlet [RMI TCP Connection(2)-127.0.0.1] Completed initialization in 2 ms
2025-06-10 23:52:00,019 DEBUG c.e.r.s.UserService [http-nio-8080-exec-2] Attempting to login user: test@example.com
2025-06-10 23:52:00,086 ERROR c.e.r.s.UserService [http-nio-8080-exec-2] User not found with email: test@example.com
2025-06-10 23:52:00,087 ERROR c.e.r.s.UserService [http-nio-8080-exec-2] Login error for user: test@example.com - Invalid email or password
2025-06-10 23:52:00,087 ERROR c.e.r.c.UserController [http-nio-8080-exec-2] Login failed: Invalid email or password
2025-06-10 23:52:05,560 INFO c.e.r.c.UserController [http-nio-8080-exec-4] trying to signup: test@example.com
2025-06-10 23:52:05,567 INFO c.e.r.s.UserService [http-nio-8080-exec-4] Starting signup process for email: test@example.com
2025-06-10 23:52:05,567 DEBUG c.e.r.s.UserService [http-nio-8080-exec-4] Processing referral code: ABC123
2025-06-10 23:52:05,567 DEBUG c.e.r.s.UserService [http-nio-8080-exec-4] Finding user by referral code: ABC123
2025-06-10 23:52:05,579 INFO c.e.r.s.UserService [http-nio-8080-exec-4] Found referrer with email: john.doe@example.com
2025-06-10 23:52:05,579 DEBUG c.e.r.s.UserService [http-nio-8080-exec-4] Checking if email already exists: test@example.com
2025-06-10 23:52:05,586 DEBUG c.e.r.s.UserService [http-nio-8080-exec-4] Generated referral code: K043O5
2025-06-10 23:52:05,586 DEBUG c.e.r.s.UserService [http-nio-8080-exec-4] Creating new user with email: test@example.com
2025-06-10 23:52:05,694 DEBUG c.e.r.s.UserService [http-nio-8080-exec-4] Saving user to database
2025-06-10 23:52:05,708 INFO c.e.r.s.UserService [http-nio-8080-exec-4] Successfully saved user with ID: 6
2025-06-10 23:52:05,708 DEBUG c.e.r.s.UserService [http-nio-8080-exec-4] Creating referral for user: test@example.com referred by: john.doe@example.com
2025-06-10 23:52:05,714 INFO c.e.r.s.UserService [http-nio-8080-exec-4] Successfully created referral for user: test@example.com referred by john.doe@example.com
2025-06-10 23:52:08,640 DEBUG c.e.r.s.UserService [http-nio-8080-exec-5] Attempting to login user: test@example.com
2025-06-10 23:52:08,643 DEBUG c.e.r.s.UserService [http-nio-8080-exec-5] Found user with email: test@example.com
2025-06-10 23:52:08,644 DEBUG c.e.r.s.UserService [http-nio-8080-exec-5] Authenticating user with email: test@example.com
2025-06-10 23:52:08,854 DEBUG c.e.r.s.UserService [http-nio-8080-exec-5] Successfully authenticated user: test@example.com
2025-06-10 23:52:08,855 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-5] Generating token for user: test@example.com
2025-06-10 23:52:08,855 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-5] Creating token for subject: test@example.com
2025-06-10 23:52:08,869 DEBUG c.e.r.s.UserService [http-nio-8080-exec-5] Generated token for user: test@example.com
2025-06-10 23:52:08,870 INFO c.e.r.s.UserService [http-nio-8080-exec-5] Successfully logged in user: test@example.com
2025-06-10 23:52:23,301 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-6] Validating token for user: test@example.com
2025-06-10 23:52:23,303 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-6] Token Validated for user: test@example.com
2025-06-10 23:52:23,306 INFO c.e.r.c.ProfileController [http-nio-8080-exec-6] Getting profile for user: test@example.com
2025-06-10 23:52:31,694 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-7] Validating token for user: test@example.com
2025-06-10 23:52:31,696 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-7] Token Validated for user: test@example.com
2025-06-10 23:52:31,714 INFO c.e.r.c.ProfileController [http-nio-8080-exec-7] Updating profile for user: test@example.com
2025-06-10 23:58:20,892 DEBUG c.e.r.s.JwtTokenUtil [http-nio-8080-exec-9] Validating token for user: test@example.com
2025-06-10 23:58:20,898 INFO c.e.r.s.JwtRequestFilter [http-nio-8080-exec-9] Token Validated for user: test@example.com
